import{e as M,u as Q,j as e,B as w,I as T,a as m,b as U,r as i,p as d,S as Y,M as G,d as J,c as K,H as W}from"./index-ByNlfbxM.js";import{F as X}from"./FileUpload-vqoJmZZ0.js";import{P as Z}from"./ProgressBar-CKe5kCn5.js";import{P as ee}from"./PDFPreview-DeEpfSjx.js";import{C as S,a as F,T as se}from"./ToolLayout-CEHQ6Lwh.js";import{S as ae}from"./sparkles-D8tgWn0U.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-pdfjs-BlOy0ZkI.js";import"./vendor-pdf-lib-CZHCEpXA.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";const re=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],te=M("arrow-right",re);const oe=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],ne=M("chart-column",oe),ie=({analysis:s,isAnalyzing:x,onApplyRecommendation:u,currentQuality:b})=>{const{t:r}=Q();if(x)return e.jsx(S,{className:"border-ocean-200 dark:border-ocean-800 bg-ocean-50/50 dark:bg-ocean-900/20",children:e.jsxs(F,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-ocean-500 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-sm text-ocean-700 dark:text-ocean-300",children:r("smartCompression.analyzing")})]})});if(!s)return null;const l=b===s.recommendedQuality;return e.jsxs(S,{className:"border-ocean-200 dark:border-ocean-800 bg-white dark:bg-gray-800 overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-br from-ocean-100/50 to-purple-100/50 dark:from-ocean-900/20 dark:to-purple-900/20 rounded-bl-full pointer-events-none"}),e.jsxs(F,{className:"p-4 space-y-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-gradient-to-br from-ocean-500 to-purple-500 rounded-lg shadow-sm",children:e.jsx(ae,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[r("smartCompression.title"),e.jsx(w,{variant:"secondary",className:"text-[10px] bg-ocean-100 text-ocean-700 dark:bg-ocean-900/50 dark:text-ocean-300 border-ocean-200",children:"AI"})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s.savingPotential==="high"?r("smartCompression.highPotential"):r("smartCompression.optimized")})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:`p-2 rounded-lg border ${s.isImageHeavy?"bg-amber-50 border-amber-100 text-amber-700 dark:bg-amber-900/10 dark:border-amber-800 dark:text-amber-400":"bg-gray-50 border-gray-100 text-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(T,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:r("smartCompression.images")})]}),e.jsx("p",{className:"text-xs opacity-80",children:s.isImageHeavy?r("smartCompression.heavy"):r("smartCompression.light")})]}),e.jsxs("div",{className:"p-2 rounded-lg border bg-gray-50 border-gray-100 text-gray-600 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:r("smartCompression.structure")})]}),e.jsx("ul",{className:"text-xs opacity-80 list-disc list-inside",children:s.insights.slice(0,1).map((c,g)=>e.jsx("li",{children:r(c.key,c.params)},g))})]})]}),e.jsxs("div",{className:"bg-ocean-50 dark:bg-ocean-900/20 rounded-lg p-3 border border-ocean-100 dark:border-ocean-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-ocean-900 dark:text-ocean-100",children:r("smartCompression.recommendation")}),e.jsx(w,{variant:"outline",className:"border-ocean-200 text-ocean-700 bg-white dark:bg-gray-800 dark:border-gray-700 dark:text-white",children:r(`compress.quality.${s.recommendedQuality}.name`)})]}),!l&&e.jsxs(m,{size:"sm",className:"w-full bg-ocean-600 hover:bg-ocean-700 text-white shadow-sm",onClick:()=>u(s.recommendedQuality),children:[e.jsx("span",{className:"mr-2",children:r("smartCompression.apply")}),e.jsx(te,{className:"w-3 h-3"})]}),l&&e.jsxs("div",{className:"text-center text-xs text-ocean-600 dark:text-ocean-400 font-medium py-1",children:["âœ“ ",r("smartCompression.applied")]})]})]})]})},je=()=>{const{t:s}=Q(),{sharedFile:x,clearSharedFile:u,setSharedFile:b}=U(),[r,l]=i.useState(null),[c,g]=i.useState("medium"),[p,C]=i.useState(!1),[_,y]=i.useState(0),[$,z]=i.useState(""),[t,N]=i.useState(null),[q,P]=i.useState(!1),[A,v]=i.useState(!1),[B,k]=i.useState(null),[L,f]=i.useState(!1);i.useEffect(()=>{if(x&&!r&&!t){const a=new File([x.blob],x.name,{type:"application/pdf"}),n={id:`${Date.now()}`,file:a,name:x.name,size:a.size,status:"pending"};l(n),P(!0),d.getPDFInfo(a).then(o=>{l(h=>h?{...h,info:o,status:"completed"}:null)}).catch(()=>{l(o=>o?{...o,status:"error",error:"Failed to read PDF"}:null)}),f(!0),d.analyzeCompression(a).then(o=>{k(o),g(o.recommendedQuality)}).catch(o=>console.error(o)).finally(()=>f(!1)),u()}},[x,r,t,u]),i.useEffect(()=>{if(t?.blob&&!p&&!A){const a=r?.name.replace(/\.pdf$/i,"_compressed.pdf")||"compressed.pdf";b(t.blob,a,"compress-pdf"),v(!0)}},[t,p,A,r?.name,b]);const R=async a=>{const n=a[0];if(!n)return;const o={id:`${Date.now()}`,file:n,name:n.name,size:n.size,status:"pending"};l(o);try{const h=await d.getPDFInfo(n);l(I=>I?{...I,info:h,status:"completed"}:null),f(!0);const D=await d.analyzeCompression(n);k(D),g(D.recommendedQuality),f(!1)}catch{l(h=>h?{...h,status:"error",error:"Failed to read PDF"}:null),f(!1)}},H=async()=>{if(r){C(!0),y(0),N(null),v(!1);try{const a=await d.compressPDF(r.file,c,(n,o)=>{y(n),z(o)});a.success&&a.data?N({blob:a.data,metadata:a.metadata}):alert(a.error?.message||"Compression failed")}catch(a){alert("An error occurred during compression"),console.error(a)}finally{C(!1)}}},E=()=>{if(t?.blob){const a=r?.name.replace(".pdf","_compressed.pdf")||"compressed.pdf";d.downloadFile(t.blob,a)}},V=()=>{l(null),N(null),v(!1),y(0),z(""),u(),P(!1),k(null)},j=a=>{if(t?.blob){const n=r?.name.replace(".pdf","_compressed.pdf")||"compressed.pdf";b(t.blob,n,"compress-pdf")}window.location.hash=W[a]},O=[{id:"low",icon:"ðŸ—œï¸",reduction:"~70%",description:s("compress.quality.low.description")},{id:"medium",icon:"âš–ï¸",reduction:"~50%",description:s("compress.quality.medium.description")},{id:"high",icon:"âœ¨",reduction:"~30%",description:s("compress.quality.high.description")}];return e.jsxs(se,{title:s("tools.compress-pdf.name"),description:s("tools.compress-pdf.description"),hasFiles:!!r,isProcessing:p,onUpload:a=>R(a),uploadContent:e.jsx(X,{accept:".pdf",multiple:!1,onFilesSelected:R,maxSizeMB:100,disabled:p,title:s("common.selectFile"),description:s("upload.singleFileAllowed")}),settings:r&&!t?e.jsxs("div",{className:"space-y-6 animate-slide-up",children:[e.jsx(ie,{analysis:B,isAnalyzing:L,currentQuality:c,onApplyRecommendation:a=>g(a)}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:"âš™ï¸"})," ",s("compress.selectQuality")]}),e.jsx("div",{className:"space-y-3",children:O.map(a=>e.jsx("div",{onClick:()=>g(a.id),className:`cursor-pointer rounded-lg border-2 p-4 transition-all ${c===a.id?"border-ocean-500 bg-ocean-50 dark:bg-ocean-900/20":"border-gray-200 dark:border-gray-700 hover:border-ocean-200 dark:hover:border-ocean-800"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"text-2xl",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`font-medium ${c===a.id?"text-ocean-700 dark:text-ocean-300":"text-gray-900 dark:text-white"}`,children:s(`compress.quality.${a.id}.name`)}),e.jsx(w,{variant:c===a.id?"default":"secondary",className:"text-xs",children:a.reduction})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:a.description})]})]})},a.id))})]})]}):null,actions:r&&!t?e.jsx(m,{onClick:H,disabled:p,className:"w-full text-lg py-6 shadow-lg shadow-ocean-500/20 bg-ocean-500 hover:bg-ocean-600 text-white",size:"lg",children:s(p?"common.processing":"compress.compressButton")}):t?e.jsxs("div",{className:"space-y-3",children:[e.jsx(m,{onClick:E,className:"w-full bg-green-600 hover:bg-green-700 text-white shadow-lg shadow-green-500/20",size:"lg",children:s("common.download")}),e.jsx(m,{onClick:V,variant:"outline",className:"w-full",children:s("compress.compressAnother")})]}):null,children:[r&&!t&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[q&&e.jsx("div",{className:"bg-ocean-50 dark:bg-ocean-900/20 border border-ocean-200 dark:border-ocean-800 rounded-lg p-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:"âœ¨"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-ocean-700 dark:text-ocean-300",children:s("compress.autoLoaded.title")}),e.jsx("p",{className:"text-sm text-ocean-600 dark:text-ocean-400",children:s("compress.autoLoaded.description")})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-ocean-500 to-purple-500 rounded-lg blur opacity-25 group-hover:opacity-50 transition duration-1000"}),e.jsx("div",{className:"relative",children:e.jsx(ee,{file:r.file,width:300,height:400})})]})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:r.name}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:[d.formatFileSize(r.size)," â€¢ ",r.info?.pages," ",s("common.pages")]})]})]}),p&&e.jsx("div",{className:"mt-8",children:e.jsx(Z,{progress:_,message:$})}),t&&e.jsxs("div",{className:"space-y-8 animate-scale-in",children:[e.jsx(S,{className:"bg-green-50/50 dark:bg-green-900/10 border-green-200 dark:border-green-800 backdrop-blur-sm overflow-hidden",children:e.jsx(F,{className:"p-8",children:e.jsxs("div",{className:"flex flex-col items-center text-center space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center animate-bounce-slow",children:e.jsx("span",{className:"text-4xl",children:"ðŸŽ‰"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t.metadata?.compressionRatio&&t.metadata.compressionRatio>0?s("compress.success.title"):s("compress.optimized.title",{defaultValue:"File is already optimized"})}),e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400 max-w-md mx-auto",children:t.metadata?.compressionRatio&&t.metadata.compressionRatio>0?e.jsxs(e.Fragment,{children:[s("compress.success.saved")," ",e.jsxs("span",{className:"text-green-600 font-bold",children:[t.metadata.compressionRatio,"%"]})]}):s("compress.optimized.description",{defaultValue:"Your PDF is already at its minimum possible size with this tool."})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8 w-full max-w-md",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:s("compress.originalSize")}),e.jsx("p",{className:"text-xl font-semibold text-gray-900 dark:text-white line-through opacity-50",children:d.formatFileSize(t.metadata?.originalSize||0)})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-green-50 dark:bg-green-900/20 border border-green-100 dark:border-green-800 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-green-500/5 dark:bg-green-400/5 animate-pulse"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mb-1 font-medium",children:s("compress.success.compressedSize")}),e.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:d.formatFileSize(t.metadata?.processedSize||0)})]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(m,{onClick:()=>j("protect-pdf"),variant:"outline",className:"h-auto py-4 flex flex-col gap-2 hover:border-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/10 transition-all hover:-translate-y-1",children:[e.jsx(Y,{className:"h-6 w-6 text-ocean-500"}),e.jsx("span",{children:s("tools.protect-pdf.name")})]}),e.jsxs(m,{onClick:()=>j("merge-pdf"),variant:"outline",className:"h-auto py-4 flex flex-col gap-2 hover:border-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/10 transition-all hover:-translate-y-1",children:[e.jsx(G,{className:"h-6 w-6 text-ocean-500"}),e.jsx("span",{children:s("tools.merge-pdf.name")})]}),e.jsxs(m,{onClick:()=>j("split-pdf"),variant:"outline",className:"h-auto py-4 flex flex-col gap-2 hover:border-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/10 transition-all hover:-translate-y-1",children:[e.jsx(J,{className:"h-6 w-6 text-ocean-500"}),e.jsx("span",{children:s("tools.split-pdf.name")})]}),e.jsxs(m,{onClick:()=>j("watermark-pdf"),variant:"outline",className:"h-auto py-4 flex flex-col gap-2 hover:border-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/10 transition-all hover:-translate-y-1",children:[e.jsx(K,{className:"h-6 w-6 text-ocean-500"}),e.jsx("span",{children:s("tools.watermark-pdf.name")})]})]})]})]})};export{je as CompressPDF};
