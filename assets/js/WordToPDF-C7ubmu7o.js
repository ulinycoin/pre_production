import{u as _,J as H,b as X,r as h,p as g,t as Y,j as a,$ as ee,a0 as ae,Q as j,N as re,a as l,O as M,B as D,m as se,a1 as oe,U as te,L as $,a2 as ne}from"./index-BaqsOxPK.js";import{T as ie,C as le}from"./ToolLayout-pcKgwv4w.js";import{D as R}from"./DownloadGate-DG4D_ywK.js";import{S as de,a as ce,b as me,c as pe,d as N}from"./select-E7jW8utT.js";import{P as he}from"./progress-CduV_vm5.js";import{Z as ge}from"./zoom-out-YMbZthSb.js";import{M as xe,C as ue,a as we}from"./maximize-OWmQZZ7H.js";import{Z as fe}from"./zoom-in-BLBJcUI6.js";import{D as ve}from"./download-0nOk4Jfy.js";import{P as be}from"./plus-DJCSgA73.js";import{R as ye}from"./refresh-cw-CE5DMPth.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-pdfjs-BlOy0ZkI.js";import"./vendor-pdf-lib-CZHCEpXA.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";import"./FileUpload-DUSj1Bnl.js";import"./index-BcRrjoDw.js";const Ze=()=>{const{t}=_(),{status:k}=H(),w=k==="pro"||k==="lifetime",{setSharedFile:W,sharedFile:x,sharedFiles:f,clearSharedFile:C,clearSharedFiles:P}=X(),F=h.useRef(null),[i,m]=h.useState([]),[c,b]=h.useState(!1),[p,T]=h.useState("formatted"),[z,L]=h.useState(2),[I,y]=h.useState(1);h.useEffect(()=>{if(i.length===0)return;const e=`${p}-1`;i.forEach(async s=>{if(s.previewGenerationKey!==e)try{const r=await g.wordToPDF(s.file,()=>{},{mode:p,quality:1});r.success&&r.data&&m(o=>o.map(n=>n.id===s.id?{...n,previewBlob:r.data,pages:r.metadata?.pageCount||1,previewGenerationKey:e}:n))}catch(r){console.error("Background preview regeneration failed:",r)}})},[p,i.length]);const v=h.useCallback(e=>{const s=e.filter(r=>{const o=r.name.toLowerCase();return o.endsWith(".docx")||o.endsWith(".doc")}).map(r=>({file:r,id:Math.random().toString(36).substring(7),isProcessing:!1,isCompleted:!1,progress:0,rotation:0,previewPage:1}));s.length<e.length&&Y.error(t("wordToPdf.errors.invalidFormat")),m(r=>[...r,...s]),s.forEach(async r=>{try{const o=await g.wordToPDF(r.file,()=>{},{mode:p,quality:1});o.success&&o.data&&m(n=>n.map(d=>d.id===r.id?{...d,previewBlob:o.data,pages:o.metadata?.pageCount||1,previewGenerationKey:`${p}-1`}:d))}catch(o){console.error("Background preview conversion failed:",o)}})},[p,t]);h.useEffect(()=>{if(i.length>0)return;const e=r=>{const o=r.name.toLowerCase();return o.endsWith(".docx")||o.endsWith(".doc")},s=[];if(f?.files?.length)f.files.forEach(r=>{const o=new File([r.blob],r.name,{type:r.blob.type});e(o)&&s.push(o)});else if(x){const r=new File([x.blob],x.name,{type:x.blob.type});e(r)&&s.push(r)}s.length>0&&v(s),x&&C(),f&&P()},[x,f,i.length,C,P,v]);const Z=e=>{m(s=>s.filter(r=>r.id!==e))},q=async e=>{try{const s=await g.wordToPDF(e.file,r=>{m(o=>o.map(n=>n.id===e.id?{...n,progress:r}:n))},{mode:p,quality:z});if(s.success&&s.data){let r=s.data;if(e.rotation!==0){const o=s.metadata?.pageCount||1,n=await g.rotatePDF(r,e.rotation,Array.from({length:o},(d,u)=>u+1));n.success&&n.data&&(r=n.data)}return{...e,isProcessing:!1,isCompleted:!0,progress:100,result:{blob:r,originalSize:s.metadata?.originalSize||0,processedSize:r.size,pageCount:s.metadata?.pageCount||1}}}else return{...e,isProcessing:!1,error:s.error?.message||t("wordToPdf.errors.conversionFailed")}}catch{return{...e,isProcessing:!1,error:t("wordToPdf.errors.conversionFailed")}}},E=async()=>{b(!0),m(s=>s.map(r=>r.isCompleted?r:{...r,isProcessing:!0,error:void 0,progress:0}));const e=[...i];for(let s=0;s<e.length;s++){if(e[s].isCompleted)continue;const r=await q(e[s]);e[s]=r,m([...e])}b(!1)},G=async(e,s)=>{if(e.result?.blob){let r=e.result.blob;if(!w&&s)try{const n=await r.arrayBuffer(),d=await g.applyWatermark(new Uint8Array(n));r=new Blob([new Uint8Array(d)],{type:"application/pdf"})}catch(n){console.error("Failed to apply watermark:",n)}const o=e.file.name.replace(/\.(docx|doc)$/i,".pdf");g.downloadFile(r,o)}},U=async()=>{const e=i.filter(o=>o.isCompleted&&o.result?.blob);if(e.length===0)return;const s=new ne;for(const o of e){let n=o.result.blob;if(!w)try{const u=await n.arrayBuffer(),V=await g.applyWatermark(new Uint8Array(u));n=new Blob([new Uint8Array(V)],{type:"application/pdf"})}catch(u){console.error("Watermarking failed for ZIP entry:",u)}const d=o.file.name.replace(/\.(docx|doc)$/i,".pdf");s.file(d,n)}const r=await s.generateAsync({type:"blob"});g.downloadFile(r,"converted_files.zip")},K=()=>{m([]),b(!1)},B=(e,s)=>{m(r=>r.map(o=>{if(o.id!==e)return o;const n=s==="cw"?90:-90;let d=(o.rotation+n)%360;return d<0&&(d+=360),{...o,rotation:d}}))},S=(e,s)=>{m(r=>r.map(o=>{if(o.id!==e||!o.pages)return o;const n=Math.min(Math.max(1,o.previewPage+s),o.pages);return{...o,previewPage:n}}))},A=e=>{if(e===0)return"0 B";const s=1024,r=["B","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(s));return`${(e/Math.pow(s,o)).toFixed(1)} ${r[o]}`},O=()=>i.length===0?null:a.jsxs("div",{className:"space-y-8",children:[a.jsx("div",{className:"flex flex-col gap-12 max-w-4xl mx-auto",children:i.map((e,s)=>a.jsx("div",{className:"relative group w-full",children:a.jsxs(le,{className:"p-8 hover:shadow-2xl transition-all duration-300 relative border-transparent hover:border-ocean-200 dark:hover:border-ocean-800 bg-white dark:bg-privacy-800 shadow-xl overflow-hidden",children:[a.jsxs("div",{className:"mb-8 flex flex-col items-center justify-center group/preview relative",children:[a.jsx(ee,{size:"hero",className:"mx-auto",overlayCenter:e.pages&&e.pages>1?a.jsxs("div",{className:"flex justify-between w-full px-4",children:[a.jsx(l,{size:"icon",variant:"secondary",className:"h-12 w-12 rounded-full shadow-lg pointer-events-auto bg-white/90 dark:bg-gray-800/90 backdrop-blur-md border hover:scale-110 transition-transform disabled:opacity-30",onClick:()=>S(e.id,-1),disabled:e.previewPage<=1,title:t("common.prevPage")||"Previous page",children:a.jsx(ue,{className:"h-6 w-6"})}),a.jsx(l,{size:"icon",variant:"secondary",className:"h-12 w-12 rounded-full shadow-lg pointer-events-auto bg-white/90 dark:bg-gray-800/90 backdrop-blur-md border hover:scale-110 transition-transform disabled:opacity-30",onClick:()=>S(e.id,1),disabled:e.previewPage>=e.pages,title:t("common.nextPage")||"Next page",children:a.jsx(we,{className:"h-6 w-6"})})]}):null,overlayTopRight:a.jsxs("div",{className:"flex flex-col gap-2 opacity-0 group-hover/preview:opacity-100 transition-opacity glass-premium dark:glass-premium-dark rounded-2xl p-2",children:[a.jsx(l,{size:"icon",variant:"ghost",className:"h-10 w-10 text-ocean-600 dark:text-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/40 rounded-xl",onClick:()=>B(e.id,"ccw"),children:a.jsx(M,{className:"h-5 w-5 transform -scale-x-100"})}),a.jsx(l,{size:"icon",variant:"ghost",className:"h-10 w-10 text-ocean-600 dark:text-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/40 rounded-xl",onClick:()=>B(e.id,"cw"),children:a.jsx(M,{className:"h-5 w-5"})})]}),overlayBottomRight:a.jsxs("div",{className:"flex gap-2 opacity-0 group-hover/preview:opacity-100 transition-opacity glass-premium dark:glass-premium-dark rounded-2xl p-2",children:[a.jsx(l,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>y(r=>Math.max(.5,r-.25)),children:a.jsx(ge,{className:"h-5 w-5"})}),a.jsx(l,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>y(1),children:a.jsx(xe,{className:"h-5 w-5"})}),a.jsx(l,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>y(r=>Math.min(2,r+.25)),children:a.jsx(fe,{className:"h-5 w-5"})})]}),overlayBottomLeft:e.pages?a.jsxs("div",{className:"opacity-0 group-hover/preview:opacity-100 transition-opacity glass-premium dark:glass-premium-dark px-3 py-2 rounded-xl text-sm font-bold text-white flex items-center gap-2 bg-ocean-600",children:[a.jsx(re,{className:"w-4 h-4"}),e.previewPage," / ",e.pages]}):null,children:e.previewBlob?a.jsx("div",{className:"w-full h-full flex items-center justify-center transition-transform duration-500 cubic-bezier(0.4, 0, 0.2, 1) origin-center shadow-2xl relative",style:{transform:`rotate(${e.rotation}deg) scale(${I})`},children:a.jsx(ae,{blob:e.previewBlob,pageNumber:e.previewPage})}):a.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 text-gray-400",children:[a.jsx(j,{className:"w-12 h-12 animate-spin text-ocean-500"}),a.jsx("p",{className:"text-sm font-medium",children:t("common.generatingPreview")||"Generating visual preview..."})]})}),e.isProcessing&&a.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-gray-900/60 backdrop-blur-sm flex items-center justify-center z-50 rounded-2xl",children:a.jsxs("div",{className:"flex flex-col items-center gap-4 w-64",children:[a.jsx(j,{className:"w-12 h-12 animate-spin text-ocean-600"}),a.jsx(he,{value:e.progress,className:"h-2 w-full"}),a.jsxs("p",{className:"text-sm font-bold text-ocean-700 dark:text-ocean-300",children:[Math.round(e.progress),"%"]})]})})]}),a.jsxs("div",{className:"flex items-center justify-between mt-6",children:[a.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[a.jsxs("div",{className:"text-xl font-bold truncate text-gray-900 dark:text-gray-100 flex items-center gap-3",title:e.file.name,children:[a.jsx(D,{variant:"secondary",className:"bg-ocean-100 dark:bg-ocean-900/40 text-ocean-700 dark:text-ocean-300 text-base py-1 px-3 rounded-lg",children:s+1}),e.file.name]}),a.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[a.jsxs("p",{className:"text-sm text-ocean-600 dark:text-ocean-400 font-semibold flex items-center gap-2",children:[a.jsx(se,{className:"w-4 h-4"}),e.pages?`${e.pages} ${t("common.pages")}`:A(e.file.size)]}),e.isCompleted&&e.result&&a.jsxs(D,{variant:"secondary",className:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border-green-200",children:[t("common.success")," â€¢ ",A(e.result.processedSize)]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[e.isCompleted&&a.jsxs(a.Fragment,{children:[a.jsx(l,{size:"icon",variant:"ghost",className:"h-11 w-11 text-ocean-600 hover:bg-ocean-50 dark:hover:bg-ocean-900/20 rounded-xl",onClick:()=>{if(e.result?.blob){const r=e.file.name.replace(/\.(docx|doc)$/i,".pdf");W(e.result.blob,r,"word-to-pdf"),window.location.hash="#edit-pdf"}},title:t("wordToPdf.editResult"),children:a.jsx(oe,{className:"h-5 w-5"})}),a.jsx(R,{toolId:"word-to-pdf",onDownload:r=>G(e,r),showWatermarkLabel:!w,children:a.jsx(l,{size:"icon",variant:"ghost",className:"h-11 w-11 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded-xl",children:a.jsx(ve,{className:"h-5 w-5"})})})]}),!c&&a.jsx(l,{size:"icon",variant:"ghost",className:"h-11 w-11 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl",onClick:()=>Z(e.id),children:a.jsx(te,{className:"h-5 w-5"})})]})]})]})},e.id))}),i.some(e=>e.isCompleted)&&i.length>1&&a.jsx("div",{className:"flex justify-center pt-8",children:a.jsx(R,{toolId:"word-to-pdf",onDownload:U,showWatermarkLabel:!w,label:t("common.downloadAll")||"Download all as ZIP"})}),!c&&i.length<10&&a.jsxs("div",{className:"flex justify-center pt-4 max-w-4xl mx-auto w-full",children:[a.jsx("input",{type:"file",ref:F,onChange:e=>{e.target.files&&v(Array.from(e.target.files)),e.target.value=""},accept:".docx,.doc",multiple:!0,className:"hidden"}),a.jsxs(l,{variant:"outline",onClick:()=>F.current?.click(),className:"border-dashed border-2 hover:border-ocean-500 hover:text-ocean-600 h-24 w-full rounded-2xl transition-all bg-gray-50/50 dark:bg-gray-900/30 text-lg font-medium",children:[a.jsx(be,{className:"w-6 h-6 mr-3"}),t("common.addFiles")||"Add more files"]})]})]}),J=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx($,{children:t("wordToPdf.conversionMode")}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsxs("div",{onClick:()=>!c&&T("formatted"),className:`cursor-pointer border-2 rounded-lg p-3 transition-all ${p==="formatted"?"border-ocean-500 bg-ocean-50 dark:bg-ocean-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"} ${c?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("div",{className:"font-semibold text-sm",children:t("wordToPdf.withFormatting")}),a.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:t("wordToPdf.formattingDescription")})]}),a.jsxs("div",{onClick:()=>!c&&T("text"),className:`cursor-pointer border-2 rounded-lg p-3 transition-all ${p==="text"?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300"} ${c?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx("div",{className:"font-semibold text-sm",children:t("wordToPdf.textOnly")}),a.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:t("wordToPdf.textDescription")})]})]})]}),p==="formatted"&&a.jsxs("div",{className:"space-y-2",children:[a.jsx($,{className:"text-sm",children:t("wordToPdf.quality")}),a.jsxs(de,{disabled:c,value:z.toString(),onValueChange:e=>L(parseInt(e)),children:[a.jsx(ce,{className:"h-9",children:a.jsx(me,{})}),a.jsxs(pe,{children:[a.jsx(N,{value:"1",children:t("wordToPdf.qualityStandard")}),a.jsx(N,{value:"2",children:t("wordToPdf.qualityHigh")}),a.jsx(N,{value:"3",children:t("wordToPdf.qualityMax")})]})]})]})]}),Q=()=>a.jsxs("div",{className:"space-y-3",children:[a.jsx(l,{onClick:E,disabled:c||i.length===0||i.every(e=>e.isCompleted),className:"w-full py-6 text-lg font-bold shadow-lg",children:c?a.jsxs(a.Fragment,{children:[a.jsx(j,{className:"w-5 h-5 mr-2 animate-spin"})," ",t("common.processing")]}):t("wordToPdf.convert")}),i.some(e=>e.isCompleted)&&!c&&a.jsxs(l,{variant:"outline",onClick:K,className:"w-full h-11 rounded-xl font-bold border-2 mt-4",children:[a.jsx(ye,{className:"mr-2 h-4 w-4"}),t("common.convertAnother")]})]});return a.jsx(ie,{title:t("tools.word-to-pdf.name"),description:t("tools.word-to-pdf.description"),hasFiles:i.length>0,onUpload:v,isProcessing:c,maxFiles:10,uploadTitle:t("common.selectFiles")||"Select Word Files",uploadDescription:t("upload.multipleFilesAllowed")||"Supports up to 10 .docx files",acceptedTypes:".doc,.docx",settings:i.length>0?J():null,actions:i.length>0?Q():null,children:O()})};export{Ze as WordToPDF};
