import{e as ae,u as te,b as se,r as c,p as N,j as e,K as re,a as m,N as R,O as P,B as oe,F as ne,d as ie,L as $,k as le,t as y}from"./index-BaqsOxPK.js";import{T as de,C as ce}from"./ToolLayout-pcKgwv4w.js";import{P as ge}from"./ProgressBar-fsNAZHx0.js";import{P as me}from"./PDFPreview-Dbiduy6B.js";import{D as xe}from"./download-0nOk4Jfy.js";import{C as he,a as pe,M as be}from"./maximize-OWmQZZ7H.js";import{Z as ue}from"./zoom-out-YMbZthSb.js";import{Z as fe}from"./zoom-in-BLBJcUI6.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-pdfjs-BlOy0ZkI.js";import"./vendor-pdf-lib-CZHCEpXA.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";import"./FileUpload-DUSj1Bnl.js";const ye=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],ve=ae("repeat",ye),De=()=>{const{t}=te(),{sharedFile:u,sharedFiles:w,clearSharedFile:I,clearSharedFiles:M,setSharedFile:A}=se(),[d,b]=c.useState([]),[g,D]=c.useState(!1),[O,f]=c.useState(0),[q,C]=c.useState(""),[l,v]=c.useState([]),[L,F]=c.useState(!1),[Z,j]=c.useState(!1),[S,K]=c.useState(90),[x,B]=c.useState("all"),[E,T]=c.useState(""),[_,z]=c.useState(1),k=c.useCallback(async(a,r=!1)=>{const s=a.map((o,n)=>({id:`${Date.now()}-${n}`,file:o,name:o.name,size:o.size,status:"pending",rotation:0,previewPage:1}));b(o=>r?s:[...o,...s]),v([]),j(!1);for(const o of s)try{const n=await N.getPDFInfo(o.file);b(i=>i.map(h=>h.id===o.id?{...h,info:n,status:"completed"}:h))}catch{b(n=>n.map(i=>i.id===o.id?{...i,status:"error",error:"Failed to read PDF"}:i))}},[]);c.useEffect(()=>{if(!L){if(w&&w.files.length>0){const a=w.files.filter(r=>r.name.toLowerCase().endsWith(".pdf")||r.blob.type==="application/pdf").map(r=>new File([r.blob],r.name,{type:r.blob.type}));a.length>0&&k(a,!0),M(),F(!0);return}if(u){if(u.name.toLowerCase().endsWith(".pdf")||u.blob.type==="application/pdf"){const r=new File([u.blob],u.name,{type:u.blob.type});k([r],!0)}I(),F(!0)}}},[w,u,L,M,I,k]),c.useEffect(()=>{l.length===1&&!g&&!Z&&(A(l[0].blob,l[0].filename,"rotate-pdf"),j(!0))},[l,g,Z,A]);const W=(a,r)=>{b(s=>s.map(o=>{if(o.id!==a)return o;const n=o.rotation||0,i=r==="cw"?(n+90)%360:(n-90+360)%360;return{...o,rotation:i}}))},H=(a,r)=>{b(s=>s.map(o=>{if(o.id!==a||!o.info)return o;const n=Math.min(Math.max(1,o.previewPage+r),o.info.pages);return{...o,previewPage:n}}))},U=a=>{b(r=>r.filter(s=>s.id!==a)),d.length<=1&&v([])},G=(a,r)=>{const s=new Set,o=a.split(",").map(n=>n.trim());for(const n of o)if(n.includes("-")){const[i,h]=n.split("-").map(p=>parseInt(p.trim()));if(!isNaN(i)&&!isNaN(h))for(let p=Math.max(1,i);p<=Math.min(r,h);p++)s.add(p)}else{const i=parseInt(n);!isNaN(i)&&i>=1&&i<=r&&s.add(i)}return Array.from(s).sort((n,i)=>n-i)},J=async()=>{if(d.length!==0){D(!0),f(0),v([]),j(!1);try{const a=[];for(let r=0;r<d.length;r++){const s=d[r];if(s.status!=="completed"||!s.info)continue;const o=s.info.pages;let n=[];if(x==="all")n=Array.from({length:o},(h,p)=>p+1);else if(n=G(E,o),n.length===0){y.error(`${t("rotate.invalidPages")} (${s.name})`);continue}const i=await N.rotatePDF(s.file,x==="all"&&s.rotation||S,n,h=>{const p=r/d.length*100+h/d.length;f(p),C(`Processing ${s.name}...`)});i.success&&i.data&&a.push({blob:i.data,filename:s.name.replace(/\.pdf$/i,"_rotated.pdf"),pages:o,originalSize:s.size})}a.length>0?(v(a),y.success(t("rotate.success"))):y.error(t("rotate.failed"))}catch(a){y.error(t("rotate.failed")),console.error(a)}finally{D(!1),f(100)}}},Q=()=>{l.length!==0&&(l.length===1?N.downloadFile(l[0].blob,l[0].filename):(f(0),C("Creating ZIP archive..."),N.downloadAsZip(l.map(a=>({blob:a.blob,filename:a.filename})),"rotated_pdfs.zip",a=>f(a)).then(()=>{y.success("ZIP archive downloaded")}).catch(()=>{y.error("Failed to create ZIP archive")})))},V=()=>{b([]),v([]),j(!1),f(0),C(""),T(""),F(!1)},X=()=>d.length===0?null:l.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-800 rounded-2xl p-8 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(re,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t("rotate.success")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:l.length===1?t("rotate.successDescription"):t("split.success.filesCreated",{count:l.length})})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsxs(m,{onClick:Q,size:"lg",className:"bg-green-600 hover:bg-green-700 text-white shadow-lg hover:shadow-xl transition-all gap-2",children:[l.length>1?e.jsx(R,{className:"w-5 h-5"}):e.jsx(xe,{className:"w-5 h-5"}),l.length>1?t("common.downloadAll"):t("common.download")]}),e.jsx(m,{onClick:V,variant:"outline",size:"lg",children:t("rotate.rotateAnother")})]})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"flex flex-col gap-12 max-w-4xl mx-auto",children:d.map((a,r)=>e.jsx("div",{className:"relative group w-full",children:e.jsxs(ce,{className:"p-8 hover:shadow-2xl transition-all duration-300 relative border-transparent hover:border-ocean-200 dark:hover:border-ocean-800 bg-white dark:bg-privacy-800 shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"mb-8 flex flex-col items-center justify-center bg-gray-50 dark:bg-gray-900/50 rounded-2xl p-8 relative overflow-hidden group/preview min-h-[600px]",children:[e.jsx("div",{className:"transition-transform duration-500 cubic-bezier(0.4, 0, 0.2, 1) origin-center shadow-2xl relative",style:{transform:`rotate(${a.rotation}deg)`},children:e.jsx(me,{file:a.file,width:450*_,height:600*_,pageNumber:a.previewPage})}),a.info&&a.info.pages>1&&e.jsxs("div",{className:"absolute inset-x-0 top-1/2 -translate-y-1/2 flex justify-between px-4 pointer-events-none",children:[e.jsx(m,{size:"icon",variant:"secondary",className:"h-12 w-12 rounded-full shadow-lg pointer-events-auto bg-white/90 dark:bg-gray-800/90 backdrop-blur-md border hover:scale-110 transition-transform disabled:opacity-30",onClick:()=>H(a.id,-1),disabled:a.previewPage<=1,title:t("rotate.prevPage"),children:e.jsx(he,{className:"h-6 w-6"})}),e.jsx(m,{size:"icon",variant:"secondary",className:"h-12 w-12 rounded-full shadow-lg pointer-events-auto bg-white/90 dark:bg-gray-800/90 backdrop-blur-md border hover:scale-110 transition-transform disabled:opacity-30",onClick:()=>H(a.id,1),disabled:a.previewPage>=a.info.pages,title:t("rotate.nextPage"),children:e.jsx(pe,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"absolute top-4 right-4 flex flex-col gap-2 opacity-0 group-hover/preview:opacity-100 transition-opacity bg-white/95 dark:bg-gray-800/95 rounded-2xl p-2 backdrop-blur-xl shadow-2xl border border-gray-100 dark:border-gray-700",children:[e.jsx(m,{size:"icon",variant:"ghost",className:"h-10 w-10 text-ocean-600 dark:text-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/40 rounded-xl",onClick:()=>W(a.id,"ccw"),title:t("rotate.counterClockwise"),children:e.jsx(P,{className:"h-5 w-5 transform -scale-x-100"})}),e.jsx(m,{size:"icon",variant:"ghost",className:"h-10 w-10 text-ocean-600 dark:text-ocean-400 hover:bg-ocean-50 dark:hover:bg-ocean-900/40 rounded-xl",onClick:()=>W(a.id,"cw"),title:t("rotate.clockwise"),children:e.jsx(P,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"absolute bottom-4 right-4 flex gap-2 opacity-0 group-hover/preview:opacity-100 transition-opacity bg-white/95 dark:bg-gray-800/95 rounded-2xl p-2 backdrop-blur-xl shadow-2xl border border-gray-100 dark:border-gray-700",children:[e.jsx(m,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>z(s=>Math.max(.5,s-.25)),title:t("common.zoomOut"),children:e.jsx(ue,{className:"h-5 w-5"})}),e.jsx(m,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>z(1),title:t("common.reset"),children:e.jsx(be,{className:"h-5 w-5"})}),e.jsx(m,{size:"icon",variant:"ghost",className:"h-10 w-10 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl",onClick:()=>z(s=>Math.min(2,s+.25)),title:t("common.zoomIn"),children:e.jsx(fe,{className:"h-5 w-5"})})]}),a.info&&e.jsxs("div",{className:"absolute bottom-4 left-4 bg-ocean-600 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg backdrop-blur-md opacity-0 group-hover/preview:opacity-100 transition-opacity flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),a.previewPage," / ",a.info.pages]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[e.jsxs("p",{className:"text-xl font-bold truncate text-gray-900 dark:text-gray-100 flex items-center gap-3",title:a.name,children:[e.jsx(oe,{variant:"secondary",className:"bg-ocean-100 dark:bg-ocean-900/40 text-ocean-700 dark:text-ocean-300 text-base py-1 px-3 rounded-lg",children:r+1}),a.name]}),a.info&&e.jsxs("p",{className:"text-sm text-ocean-600 dark:text-ocean-400 font-semibold mt-1 flex items-center gap-2",children:[e.jsx(ne,{className:"w-4 h-4"}),a.info.pages," ",t("common.pages")," • ",(a.size/1024/1024).toFixed(2)," MB"]})]}),!g&&e.jsx(m,{size:"icon",variant:"ghost",className:"h-14 w-14 text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-2xl",onClick:()=>U(a.id),children:e.jsx(ie,{className:"h-6 w-6"})})]})]})},a.id))}),g&&e.jsx("div",{className:"mt-8",children:e.jsx(ge,{progress:O,message:q})})]}),Y=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-ocean-500"}),t("rotate.settings")]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx($,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t(x==="all"?"rotate.applyToAll":"rotate.selectAngle")}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[0,90,180,270].map(a=>e.jsxs("button",{onClick:()=>{K(a),x==="all"&&b(r=>r.map(s=>({...s,rotation:a})))},disabled:g,className:`
                  p-2 rounded-xl border-2 transition-all flex flex-col items-center justify-center gap-1
                  ${S===a?"border-ocean-500 bg-ocean-50 dark:bg-ocean-900/20 text-ocean-700 dark:text-ocean-300":"border-gray-200 dark:border-gray-700 hover:border-ocean-200 dark:hover:border-ocean-800 text-gray-600 dark:text-gray-400"}
                `,children:[e.jsxs("div",{className:"text-sm font-bold",children:[a,"°"]}),e.jsx("div",{className:"text-[8px] uppercase tracking-wider font-medium opacity-70",children:a===0?"RESET":a===90?"CW":a===180?"FLIP":"CCW"})]},a))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx($,{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t("rotate.selectPages")}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("button",{onClick:()=>B("all"),disabled:g,className:`
                p-3 rounded-xl border-2 transition-all flex items-center gap-3 text-left
                ${x==="all"?"border-ocean-500 bg-ocean-50 dark:bg-ocean-900/20":"border-gray-200 dark:border-gray-700 hover:border-ocean-200"}
              `,children:[e.jsx("div",{className:`p-2 rounded-lg ${x==="all"?"bg-ocean-100 dark:bg-ocean-800 text-ocean-600":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:e.jsx(R,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:t("rotate.allPages")}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("rotate.rotateAllPages")})]})]}),e.jsxs("button",{onClick:()=>B("specific"),disabled:g,className:`
                p-3 rounded-xl border-2 transition-all flex items-center gap-3 text-left
                ${x==="specific"?"border-ocean-500 bg-ocean-50 dark:bg-ocean-900/20":"border-gray-200 dark:border-gray-700 hover:border-ocean-200"}
              `,children:[e.jsx("div",{className:`p-2 rounded-lg ${x==="specific"?"bg-ocean-100 dark:bg-ocean-800 text-ocean-600":"bg-gray-100 dark:bg-gray-800 text-gray-500"}`,children:e.jsx(ve,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-white",children:t("rotate.specificPages")}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("rotate.choosePages")})]})]})]})]}),x==="specific"&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4 animate-in slide-in-from-top-2",children:[e.jsx($,{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:t("rotate.pageNumbers")}),e.jsx(le,{type:"text",value:E,onChange:a=>T(a.target.value),placeholder:"e.g. 1, 3, 5-10",disabled:g,className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:t("rotate.pageNumbersHint",{total:d.length===1?String(d[0].info?.pages||1):"?"})})]})]}),ee=()=>e.jsx(m,{onClick:J,disabled:g||d.length===0,className:"w-full py-6 text-lg rounded-xl font-bold shadow-lg hover:shadow-xl transition-all",children:g?t("common.processing"):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),t("rotate.rotateButton"),d.length>1&&` (${d.length} ${t("common.pages")})`]})});return e.jsx(de,{title:t("tools.rotate-pdf.name"),description:t("tools.rotate-pdf.description"),hasFiles:d.length>0,onUpload:a=>k(a,!1),isProcessing:g,maxFiles:10,uploadTitle:t("common.selectFiles"),uploadDescription:t("upload.multipleFilesAllowed"),settings:l.length===0?Y():null,actions:l.length===0?ee():null,children:X()})};export{De as RotatePDF};
