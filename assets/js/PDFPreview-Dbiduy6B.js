import{r as o,u as F,j as e,o as M}from"./index-BaqsOxPK.js";import{g as R,G as S}from"./vendor-pdfjs-BlOy0ZkI.js";S.workerSrc=M;const G=({file:m,blob:x,width:i=120,height:c=160,pageNumber:g=1,onLoad:p,onError:w,className:N=""})=>{const l=o.useRef(null),[v,t]=o.useState(!0),[h,d]=o.useState(null),{t:j}=F();return o.useEffect(()=>{let r=!0;return(async()=>{if(!l.current)return;const y=x||m;if(!y){d("No file or blob provided"),t(!1);return}try{t(!0),d(null);const s=await y.arrayBuffer(),P=await R({data:s}).promise;if(!r)return;const E=Math.min(Math.max(1,g),P.numPages),f=await P.getPage(E);if(!r)return;const k=f.getViewport({scale:1}),C=Math.min(i/k.width,c/k.height),u=f.getViewport({scale:C}),n=l.current,b=n.getContext("2d");if(!b)return;n.width=u.width,n.height=u.height;const D={canvasContext:b,viewport:u,canvas:n};await f.render(D).promise,r&&(t(!1),p?.())}catch(s){if(r){const a=s instanceof Error?s:new Error("Failed to render PDF");console.error("PDFPreview error:",a),d(a.message),t(!1),w?.(a)}}})(),()=>{r=!1}},[m,x,i,c,g,p,w]),e.jsxs("div",{className:`pdf-preview relative flex items-center justify-center bg-white rounded-lg overflow-hidden shadow-sm ${N}`,style:{width:i,height:c},children:[v&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-privacy-800",children:e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:j("common.loading")})}),h&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-error-50 dark:bg-error-900/20",children:e.jsx("div",{className:"text-xs text-error-600 dark:text-error-400 p-2 text-center",children:j("common.failedToLoad")})}),e.jsx("canvas",{ref:l,className:`max-w-full max-h-full ${v||h?"hidden":""}`})]})};export{G as P};
