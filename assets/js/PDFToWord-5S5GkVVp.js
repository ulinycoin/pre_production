import{u as G,J,R as K,b as V,r as c,j as s,D as _,f as Q,g as q,h as X,m as S,i as Y,Q as f,K as ee,a as m,U as D,L as z,p as x,a2 as se}from"./index-ByNlfbxM.js";import{T as re}from"./ToolLayout-CEHQ6Lwh.js";import{D as T}from"./DownloadGate-DVCOsD5O.js";import{P as te}from"./progress-bcK_Lr93.js";import{C as ae}from"./FileUpload-vqoJmZZ0.js";import{E as oe}from"./eye-D7o574wz.js";import{P as le}from"./plus-DGIBYOu8.js";import{R as ie}from"./refresh-cw-B5_LaX6y.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-pdfjs-BlOy0ZkI.js";import"./vendor-pdf-lib-CZHCEpXA.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";import"./download-BBtiLdGt.js";const Ne=()=>{const{t:a}=G(),{status:u}=J(),w=u==="pro"||u==="lifetime",b=K.useRef(null),{sharedFile:p,clearSharedFile:j}=V(),[l,d]=c.useState([]),[i,g]=c.useState(!1),[h,v]=c.useState(null),[A,N]=c.useState(!1),[y,W]=c.useState(!0),[C,L]=c.useState(!1);c.useEffect(()=>{if(p&&l.length===0){const e={file:new File([p.blob],p.name,{type:"application/pdf"}),id:Math.random().toString(36).substring(7),isProcessing:!1,isCompleted:!1,progress:0};d([e]),j()}},[p,l.length,j]);const F=async e=>{const r=[];for(const t of e)t.name.toLowerCase().endsWith(".pdf")&&await x.validatePDF(t)&&r.push({file:t,id:Math.random().toString(36).substring(7),isProcessing:!1,isCompleted:!1,progress:0});r.length<e.length&&alert(a("pdfToWord.errors.invalidPdf")),d(t=>[...t,...r])},P=e=>{d(r=>r.filter(t=>t.id!==e))},R=async e=>{try{d(t=>t.map(o=>o.id===e.id?{...o,isProcessing:!0,error:void 0}:o));const r=await x.pdfToWord(e.file,t=>{d(o=>o.map(n=>n.id===e.id?{...n,progress:t}:n))},{includeImages:!1,smartHeadings:y,extractComments:C});if(r.success&&r.data)return{...e,isProcessing:!1,isCompleted:!0,progress:100,result:{blob:r.data,originalSize:r.metadata?.originalSize||e.file.size,processedSize:r.metadata?.processedSize||r.data.size}};throw new Error(r.error?.message||a("pdfToWord.errors.conversionFailed"))}catch(r){const t=r instanceof Error?r.message:"Conversion failed";return{...e,isProcessing:!1,isCompleted:!1,progress:0,error:t}}},E=async()=>{g(!0);const e=l.filter(r=>!r.isCompleted);for(const r of e){const t=await R(r);d(o=>o.map(n=>n.id===r.id?t:n))}g(!1)},I=(e,r=!1)=>{if(e.result?.blob){const t=e.file.name.replace(/\.pdf$/i,".docx");x.downloadFile(e.result.blob,t)}},M=async()=>{const e=new se,r=l.filter(o=>o.isCompleted&&o.result?.blob);if(r.length===0)return;for(const o of r){const n=o.file.name.replace(/\.pdf$/i,".docx");let Z=o.result.blob;e.file(n,Z)}const t=await e.generateAsync({type:"blob"});x.downloadFile(t,"converted_word_documents.zip")},B=()=>{d([]),g(!1)},H=e=>{N(!0),v(e.file)},k=e=>{if(e===0)return"0 B";const r=1024,t=["B","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(r));return`${(e/Math.pow(r,o)).toFixed(1)} ${t[o]}`},$=()=>l.length===0?null:s.jsxs("div",{className:"space-y-4",children:[l.map(e=>s.jsxs("div",{className:"bg-white dark:bg-gray-900 border rounded-xl p-4 shadow-sm transition-all hover:shadow-md",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[s.jsx("div",{className:`p-2 rounded-lg ${e.isCompleted?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:e.isCompleted?s.jsx(ee,{className:"w-5 h-5"}):s.jsx(S,{className:"w-5 h-5"})}),s.jsxs("div",{className:"overflow-hidden",children:[s.jsx("p",{className:"font-medium truncate text-sm",children:e.file.name}),s.jsx("p",{className:"text-xs text-gray-500",children:k(e.file.size)})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[e.error&&s.jsxs("div",{className:"flex items-center text-red-500 text-xs px-2 py-1 bg-red-50 rounded-md",children:[s.jsx(ae,{className:"w-3 h-3 mr-1"}),e.error]}),e.isProcessing&&s.jsx(f,{className:"w-4 h-4 animate-spin text-blue-500"}),!i&&s.jsx(m,{variant:"ghost",size:"sm",onClick:()=>H(e),className:"h-8 w-8 p-0 text-gray-400 hover:text-ocean-500",title:a("common.preview")||"Preview",children:s.jsx(oe,{className:"w-4 h-4"})}),e.isCompleted&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(T,{toolId:"pdf-to-word",onDownload:r=>I(e,r),showWatermarkLabel:!w}),!i&&s.jsx(m,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl",onClick:()=>P(e.id),children:s.jsx(D,{className:"w-5 h-5"})})]}),!i&&!e.isCompleted&&s.jsx(m,{variant:"ghost",size:"sm",className:"h-11 w-11 p-0 text-gray-400 hover:text-red-500 rounded-xl",onClick:()=>P(e.id),children:s.jsx(D,{className:"w-5 h-5"})})]})]}),(e.isProcessing||e.progress>0&&e.progress<100)&&s.jsx(te,{value:e.progress,className:"h-1 mt-3"}),e.isCompleted&&e.result&&s.jsxs("div",{className:"mt-2 text-[10px] text-green-600 font-medium",children:[a("common.success"),": ",k(e.result.processedSize)]})]},e.id)),l.some(e=>e.isCompleted)&&l.length>1&&s.jsx("div",{className:"flex justify-center pt-4",children:s.jsx(T,{toolId:"pdf-to-word",onDownload:M,showWatermarkLabel:!w,label:a("common.downloadAll")||"Download all as ZIP"})}),!i&&l.length<10&&s.jsxs("div",{className:"flex justify-center pt-2",children:[s.jsx("input",{type:"file",ref:b,onChange:e=>{e.target.files&&F(Array.from(e.target.files)),e.target.value=""},accept:".pdf",multiple:!0,className:"hidden"}),s.jsxs(m,{variant:"outline",size:"sm",onClick:()=>b.current?.click(),className:"border-dashed border-2 hover:border-ocean-500 hover:text-ocean-600 h-12 w-full rounded-xl transition-all",children:[s.jsx(le,{className:"w-4 h-4 mr-2"}),a("common.addFiles")||"Add more files"]})]})]}),U=()=>s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(z,{className:"text-base",children:a("pdfToWord.smartHeadings")||"Smart Headings"}),s.jsx("p",{className:"text-xs text-gray-500",children:a("pdfToWord.smartHeadingsDescription")||"Detect headings by font size"})]}),s.jsx("input",{type:"checkbox",className:"toggle",checked:y,onChange:e=>W(e.target.checked),disabled:i})]})}),s.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(z,{className:"text-base",children:a("pdfToWord.extractComments")||"Extract Comments"}),s.jsx("p",{className:"text-xs text-gray-500",children:a("pdfToWord.extractCommentsDescription")||"Convert PDF sticky notes to Word comments"})]}),s.jsx("input",{type:"checkbox",className:"toggle",checked:C,onChange:e=>L(e.target.checked),disabled:i})]})})]}),O=()=>s.jsxs("div",{className:"space-y-3",children:[s.jsx(m,{onClick:E,disabled:i||l.length===0||l.every(e=>e.isCompleted),className:"w-full py-6 text-lg font-bold shadow-lg",children:i?s.jsxs(s.Fragment,{children:[s.jsx(f,{className:"w-5 h-5 mr-2 animate-spin"})," ",a("common.processing")]}):a("pdfToWord.convert")}),l.some(e=>e.isCompleted)&&!i&&s.jsxs(m,{variant:"outline",onClick:B,className:"w-full h-11 rounded-xl font-bold border-2",children:[s.jsx(ie,{className:"mr-2 h-4 w-4"}),a("common.convertAnother")]})]});return s.jsxs(re,{title:a("tools.pdf-to-word.name"),description:a("tools.pdf-to-word.description"),hasFiles:l.length>0,onUpload:F,isProcessing:i,maxFiles:10,uploadTitle:a("common.selectFiles")||"Select PDF Files",uploadDescription:a("upload.multipleFilesAllowed")||"Supports up to 10 PDF files",acceptedTypes:".pdf",settings:l.length>0?U():null,actions:l.length>0?O():null,children:[$(),s.jsx(_,{open:!!h,onOpenChange:e=>!e&&v(null),children:s.jsxs(Q,{className:"max-w-4xl max-h-[90vh] overflow-hidden flex flex-col p-6",children:[s.jsxs(q,{className:"mb-4",children:[s.jsxs(X,{className:"flex items-center gap-2",children:[s.jsx(S,{className:"w-5 h-5 text-red-600"}),h?.name]}),s.jsx(Y,{children:a("common.filePreview")||"File preview"})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 dark:bg-gray-950 rounded-lg flex items-center justify-center p-4 relative min-h-[400px]",children:[A&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50/50 dark:bg-gray-950/50 z-10",children:s.jsx(f,{className:"w-8 h-8 animate-spin text-ocean-600"})}),h&&s.jsx("iframe",{src:URL.createObjectURL(h)+"#toolbar=0&navpanes=0&scrollbar=0",className:"w-full h-full min-h-[600px] border-0 rounded-md shadow-inner bg-white",title:"PDF Preview",onLoad:()=>N(!1)})]})]})})]})};export{Ne as PDFToWord};
