import{u as ne,b as ce,r as n,j as e,a as d,X as ie,Q as de,p as j,t as I,m as me,K as B,B as ge,U as pe,M as xe,S as he,c as ue,W as fe,L as f,k as v,H as be}from"./index-ByNlfbxM.js";import{T as je,C as L}from"./ToolLayout-CEHQ6Lwh.js";import{P as ve}from"./ProgressBar-CKe5kCn5.js";import{S as M,a as D,b as R,c as E,d as S}from"./select-bI2aXbro.js";import{u as Ne}from"./usePDFThumbnails-eY65WYZv.js";import{QUALITY_SETTINGS as we}from"./image.types-PEpk4Te7.js";import{D as _}from"./download-BBtiLdGt.js";import{Z as ye}from"./zoom-in-ByqnYBDA.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-pdfjs-BlOy0ZkI.js";import"./vendor-pdf-lib-CZHCEpXA.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";import"./FileUpload-vqoJmZZ0.js";import"./index-NZhszMUr.js";const Re=()=>{const{t}=ne();ce();const[l,g]=n.useState([]),[i,C]=n.useState(0),[N,w]=n.useState(!1),[b,U]=n.useState("png"),[P,G]=n.useState("medium"),[p,H]=n.useState("all"),[y,F]=n.useState({start:1,end:1}),[T,Q]=n.useState(""),[k,q]=n.useState("#ffffff"),[u,z]=n.useState(null),[Z,A]=n.useState(null),[O,$]=n.useState(!1),{thumbnails:V,isLoading:K}=Ne({file:l[i]?.file,thumbnailWidth:200,thumbnailHeight:280});n.useEffect(()=>{(async()=>{const r=l[i]?.file;if(u!==null&&r){$(!0),A(null);try{const a=await j.renderPageAsImage(r,u,2.5);A(a)}catch(a){console.error("Failed to load zoomed image",a),I.error(t("common.error"))}finally{$(!1)}}})()},[u,i,l,t]);const W=s=>{const r=s.map(a=>({file:a,result:null,previews:[],progress:0,progressMessage:"",isProcessing:!1}));g(a=>[...a,...r]),l.length===0&&C(0)},J=()=>{g([]),w(!1)},X=async()=>{if(l.length===0)return;w(!0);const s={format:b,quality:P,pages:p,backgroundColor:b==="jpeg"?k:void 0};if(p==="range")s.pageRange=y;else if(p==="specific"){const r=T.split(",").map(a=>parseInt(a.trim())).filter(a=>!isNaN(a)&&a>0);s.pageNumbers=r}for(let r=0;r<l.length;r++){const a=l[r];if(!a.result){g(o=>o.map((x,c)=>c===r?{...x,isProcessing:!0}:x));try{const o=await j.pdfToImages(a.file,s,c=>{g(m=>m.map((h,oe)=>oe===r?{...h,progress:c.percentage,progressMessage:c.message||""}:h))}),x=o.success&&o.images.length>0?o.images.slice(0,5).map(c=>c.dataUrl):[];g(c=>c.map((m,h)=>h===r?{...m,result:o,previews:x,isProcessing:!1,progress:100}:m))}catch(o){console.error("Conversion error:",o);const x={success:!1,images:[],totalPages:0,originalSize:a.file.size,convertedSize:0,error:t("pdfToImages.errors.conversionFailed")};g(c=>c.map((m,h)=>h===r?{...m,result:x,isProcessing:!1}:m))}}}w(!1)},Y=async s=>{const r=l[s];if(r?.result?.success)try{const a=`${r.file.name.replace(/\.pdf$/i,"")}_images.zip`;await j.downloadImagesAsZip(r.result.images,a)}catch(a){console.error("ZIP error:",a),I.error("Failed to create ZIP")}},ee=async()=>{const s=[];if(l.forEach(r=>{r.result?.success&&s.push(...r.result.images)}),s.length)try{await j.downloadImagesAsZip(s,"all_converted_images.zip")}catch(r){console.error("ZIP error:",r),I.error("Failed to create ZIP")}},se=async s=>{const r=l[i];!r?.result?.success||!r.result.images.length||(window.location.hash=be[s])},ae=s=>{if(s===0)return"0 B";const r=1024,a=["B","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(r));return`${(s/Math.pow(r,o)).toFixed(1)} ${a[o]}`},re=()=>{if(l.length===0)return null;const s=l[i];if(!s)return null;const r=l.filter(a=>a.result?.success).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 bg-white/80 dark:bg-gray-800/80 p-3 rounded-xl border border-gray-100 dark:border-gray-700 sticky top-0 z-20 shadow-sm backdrop-blur-md",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-x-auto no-scrollbar max-w-full pb-1",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-ocean-50/50 dark:bg-ocean-900/10 px-3 py-1.5 rounded-lg border border-ocean-100 dark:border-ocean-900/20 mr-2",children:[e.jsx(me,{className:"w-4 h-4 text-ocean-600"}),e.jsxs("span",{className:"text-sm font-semibold text-ocean-900 dark:text-ocean-100 whitespace-nowrap",children:[l.length," ",t("common.selectFiles")]})]}),l.map((a,o)=>e.jsxs(d,{variant:o===i?"secondary":"ghost",size:"sm",onClick:()=>C(o),className:`flex-shrink-0 h-9 px-3 gap-2 ${o===i?"bg-ocean-100 text-ocean-700 border border-ocean-200":""}`,children:[e.jsx("span",{className:"max-w-[120px] truncate text-xs font-medium",children:a.file.name}),a.result?.success&&e.jsx(B,{className:"w-3 h-3 text-green-500"})]},o)),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>document.getElementById("file-upload-input")?.click(),className:"flex-shrink-0 h-9 px-3 border-dashed border-ocean-300 text-ocean-600 hover:bg-ocean-50",children:e.jsxs("span",{className:"text-xs font-bold",children:["+ ",t("common.addFiles")]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r>0&&e.jsxs(ge,{className:"bg-green-100 text-green-700 hover:bg-green-100 border-none px-2 py-1",children:[r," / ",l.length," ",t("common.done")]}),e.jsxs(d,{onClick:J,variant:"ghost",size:"sm",className:"text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 h-9",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline text-xs font-bold uppercase tracking-wider",children:t("common.clearAll")})]})]})]}),s.result?.success&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-green-50/50 dark:bg-green-900/10 border border-green-100 dark:border-green-900/20 rounded-2xl animate-in zoom-in-95 duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center text-green-600",children:e.jsx(B,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-900 dark:text-green-100",children:t("pdfToImages.success")}),e.jsxs("p",{className:"text-xs text-green-700/70 dark:text-green-300/70",children:[s.result.images.length," ",t("pdfToImages.imagesCreated")," â€¢ ",ae(s.result.convertedSize)]})]})]}),e.jsxs(d,{onClick:()=>Y(i),size:"sm",className:"bg-green-600 hover:bg-green-700 shadow-lg shadow-green-600/20",children:[e.jsx(_,{className:"w-4 h-4 mr-2"})," ",t("pdfToImages.downloadZip")]})]}),s.isProcessing&&e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 p-6 rounded-3xl border border-ocean-100/50 dark:border-gray-700/50 backdrop-blur-sm",children:e.jsx(ve,{progress:s.progress,message:s.progressMessage})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6",children:K?Array.from({length:10}).map((a,o)=>e.jsx(L,{className:"aspect-[1/1.4] animate-pulse bg-gray-100/50 dark:bg-gray-800/50 border-none rounded-2xl"},o)):V.map(a=>e.jsxs(L,{className:"relative group overflow-hidden cursor-default transition-all duration-500 border-transparent hover:border-ocean-300 dark:hover:border-ocean-700 hover:shadow-glow/20 bg-white dark:bg-[#18181b] rounded-2xl liquid-glass-card",children:[e.jsx("div",{className:"card-glass group-hover:bg-white/50 dark:group-hover:bg-[#1c1c1e]/50 transition-colors"}),e.jsx("div",{className:"card-glow group-hover:opacity-100"}),e.jsxs("div",{className:"relative z-10 w-full h-full flex flex-col",children:[e.jsx("div",{className:"absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-1 group-hover:translate-y-0 z-20",children:e.jsx(d,{size:"icon",variant:"secondary",className:"h-9 w-9 bg-white/90 dark:bg-black/50 backdrop-blur-md shadow-lg border border-white/20 hover:scale-110 transition-transform",onClick:o=>{o.stopPropagation(),z(a.pageNumber)},children:e.jsx(ye,{className:"h-5 w-5 text-ocean-600"})})}),e.jsx("div",{className:"p-3 aspect-[1/1.4] flex items-center justify-center bg-gray-50/50 dark:bg-gray-900/30 transition-all duration-500 group-hover:bg-transparent",children:e.jsx("img",{src:a.dataUrl,alt:`Page ${a.pageNumber}`,className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm transition-transform duration-500 group-hover:scale-105"})}),e.jsxs("div",{className:"py-2 text-center text-[10px] font-bold text-gray-400 bg-white/80 dark:bg-gray-800/40 border-t border-gray-100 dark:border-white/5 uppercase tracking-widest backdrop-blur-sm mt-auto",children:[t("common.page")," ",a.pageNumber]})]})]},`${i}-${a.pageNumber}`))}),l.some(a=>a.result?.success)&&e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 pt-8",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(d,{onClick:ee,className:"w-full max-w-lg bg-ocean-600 hover:bg-ocean-700 shadow-2xl shadow-ocean-600/30 py-7 text-xl font-black rounded-2xl transition-all hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx(_,{className:"w-6 h-6 mr-3"})," ",t("pdfToImages.downloadAll")," (ZIP)"]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 max-w-2xl mx-auto",children:["compress-pdf","protect-pdf","watermark-pdf","merge-pdf"].map(a=>e.jsxs(d,{onClick:()=>se(a),variant:"outline",className:"h-auto py-4 flex flex-col gap-2 rounded-xl border-gray-200 dark:border-gray-700 hover:border-ocean-300 dark:hover:border-ocean-700 hover:bg-ocean-50/50 dark:hover:bg-ocean-900/10 transition-all",children:[a==="compress-pdf"&&e.jsx(xe,{className:"h-5 w-5 text-ocean-500"}),a==="protect-pdf"&&e.jsx(he,{className:"h-5 w-5 text-ocean-500"}),a==="watermark-pdf"&&e.jsx(ue,{className:"h-5 w-5 text-ocean-500"}),a==="merge-pdf"&&e.jsx(fe,{className:"h-5 w-5 text-ocean-500"}),e.jsx("span",{className:"text-xs font-semibold",children:t(`tools.${a}.name`)})]},a))})]})]})},te=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:t("pdfToImages.format")}),e.jsxs(M,{value:b,onValueChange:s=>U(s),children:[e.jsx(D,{children:e.jsx(R,{})}),e.jsxs(E,{children:[e.jsx(S,{value:"png",children:"PNG"}),e.jsx(S,{value:"jpeg",children:"JPEG"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{children:t("pdfToImages.quality")}),e.jsxs(M,{value:P,onValueChange:s=>G(s),children:[e.jsx(D,{children:e.jsx(R,{})}),e.jsx(E,{children:Object.entries(we).map(([s,r])=>e.jsxs(S,{value:s,children:[s.charAt(0).toUpperCase()+s.slice(1)," (",r.resolution," DPI)"]},s))})]})]}),e.jsxs("div",{className:"space-y-3 border-t pt-4",children:[e.jsx(f,{children:t("pdfToImages.pages")}),e.jsx("div",{className:"space-y-2",children:["all","range","specific"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:`page-${s}`,checked:p===s,onChange:()=>H(s),className:"text-ocean-600 focus:ring-ocean-500"}),e.jsx(f,{htmlFor:`page-${s}`,className:"cursor-pointer",children:t(`pdfToImages.${s==="range"?"pageRange":s==="specific"?"specificPages":"allPages"}`)})]},s))}),p==="range"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{type:"number",min:1,value:y.start,onChange:s=>F(r=>({...r,start:parseInt(s.target.value)||1})),placeholder:"From"}),e.jsx("span",{className:"self-center",children:"-"}),e.jsx(v,{type:"number",min:1,value:y.end,onChange:s=>F(r=>({...r,end:parseInt(s.target.value)||1})),placeholder:"To"})]}),p==="specific"&&e.jsx(v,{placeholder:"e.g. 1, 3, 5-10",value:T,onChange:s=>Q(s.target.value)})]}),b==="jpeg"&&e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx(f,{children:t("pdfToImages.backgroundColor")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{type:"color",value:k,onChange:s=>q(s.target.value),className:"w-10 h-10 p-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:k})]})]})]}),le=()=>e.jsx(d,{onClick:X,disabled:N||!l.some(s=>!s.result),className:"w-full py-6 text-lg font-bold",children:t(N?"common.processing":"pdfToImages.convert")});return e.jsxs(e.Fragment,{children:[e.jsx(je,{title:t("tools.pdf-to-images.name"),description:t("tools.pdf-to-images.description"),hasFiles:l.length>0,onUpload:W,isProcessing:N,maxFiles:20,uploadTitle:t("common.selectFile"),uploadDescription:t("upload.multipleFilesAllowed"),acceptedTypes:".pdf",settings:l.length>0?te():null,actions:l.length>0?le():null,children:re()}),u!==null&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] bg-white dark:bg-gray-900 rounded-2xl overflow-hidden shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-800 flex items-center justify-between",children:[e.jsxs("span",{className:"font-bold text-lg",children:[t("common.page")," ",u]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>z(null),children:e.jsx(ie,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 flex items-center justify-center min-h-0",children:O?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(de,{className:"h-8 w-8 animate-spin text-ocean-500"}),e.jsx("span",{className:"text-sm text-gray-500",children:t("common.loading")})]}):Z?e.jsx("img",{src:Z,alt:"Zoomed page",className:"max-w-full h-auto shadow-lg rounded-lg"}):null})]})})]})};export{Re as PDFToImages};
