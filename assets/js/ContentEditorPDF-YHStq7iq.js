import{e as ee,r as i,j as e,Q as Le,u as Se,a as A,U as $e,L as be,O as Ee,J as Ie,Y as Xe,b as We,K as _e,p as Ye,o as qe}from"./index-ByNlfbxM.js";import{T as ke}from"./ToolLayout-CEHQ6Lwh.js";import{P as Oe,r as Me,d as Ve,f as Ue,S as xe}from"./vendor-pdf-lib-CZHCEpXA.js";import{g as Ke,G as Ge}from"./vendor-pdfjs-BlOy0ZkI.js";import{P as Ae}from"./plus-DGIBYOu8.js";import{S as Je}from"./sparkles-D8tgWn0U.js";import{C as Qe,a as Ze,M as et}from"./maximize-BmIDxvOV.js";import{C as Ne,e as Fe,S as tt,a as at,b as st,c as rt,d as nt}from"./select-bI2aXbro.js";import{T as Ce,P as ot}from"./type-CH8bP--F.js";import{S as it}from"./square-_W1DGeXi.js";import{D as lt}from"./DownloadGate-DVCOsD5O.js";import{R as ct}from"./refresh-cw-B5_LaX6y.js";import"./vendor-react-CTjRfaZN.js";import"./vendor-word-CeUssL8V.js";import"./vendor-ocr-CTFn7PEu.js";import"./FileUpload-vqoJmZZ0.js";import"./index-NZhszMUr.js";import"./download-BBtiLdGt.js";const dt=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Be=ee("bold",dt);const ht=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],ut=ee("ghost",ht);const ft=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],He=ee("italic",ft);const gt=[["path",{d:"M5 12h14",key:"1ays0h"}]],xt=ee("minus",gt);const mt=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],pt=ee("mouse-pointer-2",mt);const bt=[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]],wt=ee("redo",bt);const yt=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],vt=ee("save",yt);const jt=[["rect",{width:"20",height:"6",x:"2",y:"4",rx:"2",key:"qdearl"}],["rect",{width:"20",height:"6",x:"2",y:"14",rx:"2",key:"1xrn6j"}]],kt=ee("stretch-horizontal",jt);const Nt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],Ft=ee("text-align-center",Nt);const Ct=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],St=ee("text-align-end",Ct);const Tt=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],Rt=ee("text-align-start",Tt);const Mt=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],zt=ee("undo",Mt),$t=a=>a.replace(/[\x00-\x1F\x7F-\x9F]/g,"").replace(/[""]/g,'"').replace(/['']/g,"'").replace(/[–—]/g,"-").replace(/[…]/g,"..."),At=(a,b,F,w,S)=>{const I=b.split(`
`),X=S.size,T=S.font,_=X*1.2,l=I.length*_,B=S.textAlign||"center",H=S.scaleX||1;let z=w+l/2-X*1.1;I.forEach(P=>{const R=$t(P);if(R.trim()){const L=T;if(!L||typeof L.widthOfTextAtSize!="function"){console.warn("Invalid font passed to drawMultilineText");return}try{const W=L.widthOfTextAtSize(R,X)*H;let Y=F;B==="center"?Y=F-W/2:B==="right"&&(Y=F-W),a.drawText(R,{...S,x:Y,y:z,font:L})}catch(D){console.error("Error drawing line:",D,R)}}z-=_})},Bt=()=>{const[a,b]=i.useState([]),[F,w]=i.useState(null),[S,I]=i.useState(1),[X,T]=i.useState(1),[_,l]=i.useState(1),[B,H]=i.useState("edit"),[z,P]=i.useState(!1),[R,L]=i.useState([[]]),[D,W]=i.useState(0),Y=i.useRef(0),K=i.useRef([]);i.useEffect(()=>{K.current=a},[a]);const V=i.useCallback(c=>{L(t=>{const o=t.slice(0,D+1);return o.push([...c]),o}),W(t=>t+1)},[D]),q=i.useCallback((c,t,o="New Text",f)=>{const y={id:`text-${Date.now()}-${++Y.current}`,text:o,x:c,y:t,fontSize:24,fontFamily:"Roboto",color:"#000000",opacity:100,rotation:0,bold:!1,italic:!1,isSelected:!1,pageNumber:S,backgroundColor:"transparent",textAlign:"left",horizontalScaling:1,...f},N=[...a,y];return b(N),w(y.id),V(N),y.id},[S,a,V]),U=i.useCallback((c,t)=>{const o=K.current.map(f=>f.id===c?{...f,...t}:f);b(o),V(o)},[V]),ae=i.useCallback(c=>{const t=K.current.filter(o=>o.id!==c);b(t),V(t),F===c&&w(null)},[F,V]),G=i.useCallback(c=>{w(c)},[]),oe=i.useCallback((c,t,o)=>{const f=K.current.map(y=>y.id===c?{...y,x:t,y:o}:y);b(f)},[]),J=i.useCallback(()=>{V(K.current)},[V]),we=i.useCallback(c=>I(c),[]),de=i.useCallback(c=>T(c),[]),he=i.useCallback(c=>l(c),[]),ie=i.useCallback(c=>H(c),[]),le=i.useCallback(()=>{if(D>0){const c=D-1;W(c),b([...R[c]])}},[R,D]),ue=i.useCallback(()=>{if(D<R.length-1){const c=D+1;W(c),b([...R[c]])}},[R,D]),fe=i.useCallback(async(c,t,o,f)=>{try{const y=await c.getPage(t),N=await y.getTextContent({includeStyles:!0}),m=y.getViewport({scale:1}),j=o/100*m.width,g=f/100*m.height;let s=null,n=1/0;for(const k of N.items){if(!("str"in k))continue;const u=k.transform,ne=Math.sqrt(u[0]*u[0]+u[1]*u[1]),ye=u[4],ve=m.height-u[5]-(k.height||ne),Te=k.width||k.str.length*ne*.5,De=k.height||ne,Pe=ye+Te/2,Re=ve+De/2,je=Math.sqrt(Math.pow(j-Pe,2)+Math.pow(g-Re,2));je<n&&je<50&&(n=je,s={item:k,fontSize:ne,centerY:Re})}if(!s)return null;const d=s.fontSize*.5,r=N.items.filter(k=>{if(!("str"in k))return!1;const u=m.height-k.transform[5]-(k.height||s.fontSize),ne=Math.sqrt(k.transform[0]*k.transform[0]+k.transform[1]*k.transform[1]),ye=u+(k.height||ne)/2;return Math.abs(ye-s.centerY)<d}).sort((k,u)=>k.transform[4]-u.transform[4]);if(r.length===0)return null;const v=r[0],p=r[r.length-1],x=v.transform[4],$=p.transform[4],h=p.width||p.str.length*s.fontSize*.5,O=$+h-x,Z=N.styles[s.item.fontName];let E="Roboto",M=!1,C=!1;const se=Math.sqrt(s.item.transform[0]*s.item.transform[0]+s.item.transform[1]*s.item.transform[1]),pe=Math.sqrt(s.item.transform[2]*s.item.transform[2]+s.item.transform[3]*s.item.transform[3]),ge=Math.round(Math.max(se,pe)*100)/100;if(Z){const k=Z.fontFamily||"",u=(k.includes("+")?k.split("+")[1]:k).toLowerCase();M=u.includes("bold")||u.includes("heavy")||u.includes("black")||u.includes("medium")||u.includes("demi"),C=u.includes("italic")||u.includes("oblique")||u.includes("slanted"),u.includes("roboto")?E="Roboto":u.includes("arial")||u.includes("helvetica")||u.includes("sans")||u.includes("inter")||u.includes("system")||u.includes("tahoma")||u.includes("verdana")||u.includes("calibri")||u.includes("segoe")?E="Arial":u.includes("times")||u.includes("serif")||u.includes("minion")||u.includes("garamond")||u.includes("georgia")?E="Times New Roman":(u.includes("courier")||u.includes("mono")||u.includes("code")||u.includes("terminal")||u.includes("consolas"))&&(E="Courier New")}else{const k=s.item.fontName.toLowerCase();M=k.includes("bold"),C=k.includes("italic")}let re="";for(let k=0;k<r.length;k++){const u=r[k];if(k>0){const ne=r[k-1],ye=ne.transform[4],ve=ne.width||ne.str.length*s.fontSize*.5;u.transform[4]-(ye+ve)>s.fontSize*.1&&!re.endsWith(" ")&&!u.str.startsWith(" ")&&(re+=" ")}re+=u.str}return re=re.replace(/\s+/g," ").trim(),{text:re,x:(x+O/2)/m.width*100,y:s.centerY/m.height*100,width:O/m.width*100,height:ge*1.1/m.height*100,fontSize:ge,fontFamily:E,bold:M,italic:C}}catch(y){return console.error("Error detecting text line:",y),null}},[]),Q=c=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:0,g:0,b:0}},te=async c=>{c.registerFontkit(Ue);const t={},o=["Roboto-Regular","Roboto-Bold","Roboto-Italic","Roboto-BoldItalic"];try{for(const r of o){let v=await fetch(`/fonts/${r}.ttf`);if(v.ok){if((v.headers.get("content-type")||"").includes("text/html")){console.warn(`Font fetch for ${r} returned HTML (status: ${v.status}). Skipping.`);continue}const x=await v.arrayBuffer();try{t[r]=await c.embedFont(x)}catch($){console.error(`Error embedding font ${r}:`,$)}}}}catch(r){console.warn("Failed to load local or CDN fonts:",r)}const f=await c.embedFont(xe.Helvetica),y=await c.embedFont(xe.HelveticaBold),N=await c.embedFont(xe.HelveticaOblique),m=await c.embedFont(xe.HelveticaBoldOblique),j=await c.embedFont(xe.Courier),g=await c.embedFont(xe.CourierBold),s=await c.embedFont(xe.TimesRoman),n=await c.embedFont(xe.TimesRomanBold);return{getBestFontForElement:r=>{const v=/[^\x00-\x7F]/.test(r.text);if(r.fontFamily==="Roboto"||r.fontFamily==="Arial"||v){let x=null;return r.bold&&r.italic?x=t["Roboto-BoldItalic"]:r.bold?x=t["Roboto-Bold"]:r.italic?x=t["Roboto-Italic"]:x=t["Roboto-Regular"],x||(x=t["Roboto-Regular"]),x||(r.bold&&r.italic?m:r.bold?y:r.italic?N:f)}return r.fontFamily==="Courier New"||r.fontFamily==="Courier"?r.bold?g:j:r.fontFamily==="Times New Roman"||r.fontFamily==="Times"?r.bold?n:s:f}}},ce=i.useCallback(async c=>{P(!0);try{const t=await c.arrayBuffer(),o=await Oe.load(t),{getBestFontForElement:f}=await te(o),y=a.reduce((m,j)=>(m[j.pageNumber]||(m[j.pageNumber]=[]),m[j.pageNumber].push(j),m),{});Object.entries(y).forEach(([m,j])=>{const g=parseInt(m)-1;if(g<0||g>=o.getPageCount())return;const s=o.getPage(g),{width:n,height:d}=s.getSize();j.forEach(r=>{const v=Q(r.color),p=f(r),x=r.x/100*n,$=d-r.y/100*d;if(r.originalRect){const h=r.originalRect.x/100*n,O=d-r.originalRect.y/100*d,Z=r.originalRect.w/100*n,E=r.originalRect.h/100*d,M=Q(r.backgroundColor||"#FFFFFF");s.drawRectangle({x:h,y:O-E,width:Z,height:E,color:Me(M.r,M.g,M.b)})}At(s,r.text,x,$,{size:r.fontSize,color:Me(v.r,v.g,v.b),font:p,opacity:r.opacity/100,rotate:Ve(r.rotation),textAlign:r.textAlign||"center",scaleX:r.horizontalScaling||1})})});const N=await o.save();return new Blob([N],{type:"application/pdf"})}catch(t){throw console.error("Error saving PDF:",t),t}finally{P(!1)}},[a]),me=i.useCallback(()=>{b([]),w(null),I(1),T(1),l(1),H("edit"),L([[]]),W(0),Y.current=0},[]);return{textElements:a,selectedElementId:F,currentPage:S,totalPages:X,scale:_,toolMode:B,isProcessing:z,canUndo:D>0,canRedo:D<R.length-1,addTextElement:q,updateTextElement:U,deleteTextElement:ae,selectElement:G,moveElement:oe,finishMovement:J,goToPage:we,setTotalPages:de,setScale:he,setToolMode:ie,undo:le,redo:ue,detectTextAt:fe,savePDF:ce,reset:me}},Ht=({pdfDocument:a,currentPage:b,textElements:F,selectedElementId:w,toolMode:S,onCanvasClick:I,onElementSelect:X,onElementMove:T,onElementUpdate:_,onTotalPagesChange:l,onSmartDetect:B,isDocumentLoading:H})=>{const z=i.useRef(null),P=i.useRef(null),[R,L]=i.useState({width:0,height:0}),[D,W]=i.useState({width:0,height:0}),[Y]=i.useState(1.5),[K,V]=i.useState(!1),q=i.useRef(null),U=i.useRef(!1),ae=i.useCallback(async(t,o)=>{if(!(U.current||!z.current)){U.current=!0,V(!0);try{const f=await t.getPage(o),y=f.getViewport({scale:Y}),N=z.current,m=N.getContext("2d");if(!m)return;N.width=y.width,N.height=y.height,L({width:y.width,height:y.height}),q.current&&q.current.cancel(),q.current=f.render({canvasContext:m,viewport:y,canvas:z.current}),await q.current.promise,q.current=null;const j=f.getViewport({scale:1});W({width:j.width,height:j.height});const g=await f.getTextContent(),s=f.getViewport({scale:1}),n=g.items.map(d=>{if(!("str"in d))return null;const r=d.transform,v=Math.sqrt(r[0]*r[0]+r[1]*r[1]),p=r[4],x=s.height-r[5]-(d.height||v),$=d.width||d.str.length*v*.5,h=d.height||v;return{x:p/s.width*100,y:x/s.height*100,w:$/s.width*100,h:h/s.height*100}}).filter(Boolean);ue(n)}catch(f){console.error("Error rendering page:",f)}finally{U.current=!1,V(!1)}}},[Y]),[G,oe]=i.useState(!1),[J,we]=i.useState(null),de=i.useRef(null),[he,ie]=i.useState({x:[],y:[]}),[le,ue]=i.useState([]),fe=(t,o)=>{t.stopPropagation(),X(o);const f=F.find(m=>m.id===o);if(!f)return;oe(!0),we(o);const y="touches"in t?t.touches[0].clientX:t.clientX,N="touches"in t?t.touches[0].clientY:t.clientY;if(P.current){const m=P.current.getBoundingClientRect(),g=document.getElementById(`text-el-${o}`)?.getBoundingClientRect()||{width:0,height:0};de.current={startX:y,startY:N,containerWidth:m.width,containerHeight:m.height,elementHalfW:g.width/2/m.width*100,elementHalfH:g.height/2/m.height*100,elementOriginalX:f.x,elementOriginalY:f.y,others:F.filter(s=>s.id!==o&&s.pageNumber===b).map(s=>{const n=document.getElementById(`text-el-${s.id}`);if(!n)return null;const d=n.getBoundingClientRect();return{id:s.id,x:s.x,y:s.y,halfW:d.width/2/m.width*100,halfH:d.height/2/m.height*100}}).filter(s=>s!==null)}}},Q=i.useCallback(t=>{if(!G||!J||!de.current)return;const o=de.current,f="touches"in t?t.touches[0].clientX:t.clientX,y="touches"in t?t.touches[0].clientY:t.clientY,N=(f-o.startX)/o.containerWidth*100,m=(y-o.startY)/o.containerHeight*100;if(!G&&(Math.abs(N)>.1||Math.abs(m)>.1)&&oe(!0),!G)return;const j=F.find(h=>h.id===J);if(!j)return;let g=o.elementOriginalX+N,s=o.elementOriginalY+m;const n=1,d=new Set,r=new Set,v=[0,50,100],p=[0,50,100],x=o.elementHalfW,$=o.elementHalfH;v.forEach(h=>{Math.abs(g-x-h)<n?(g=h+x,d.clear(),d.add(h)):Math.abs(g-h)<n?(g=h,d.clear(),d.add(h)):Math.abs(g+x-h)<n&&(g=h-x,d.clear(),d.add(h))}),p.forEach(h=>{Math.abs(s-$-h)<n?(s=h+$,r.clear(),r.add(h)):Math.abs(s-h)<n?(s=h,r.clear(),r.add(h)):Math.abs(s+$-h)<n&&(s=h-$,r.clear(),r.add(h))}),o.others.forEach(h=>{const O=[];j.textAlign==="left"?O.push(g,g+x*2):j.textAlign==="right"?O.push(g-x*2,g):O.push(g-x,g,g+x);const Z=[h.x-h.halfW,h.x,h.x+h.halfW];O.forEach((E,M)=>{Z.forEach(C=>{Math.abs(E-C)<n&&(j.textAlign==="left"?g=M===0?C:C-x*2:j.textAlign==="right"?g=M===1?C:C+x*2:M===0?g=C+x:M===1?g=C:M===2&&(g=C-x),d.clear(),d.add(C))})}),Math.abs(s-h.y)<n&&(s=h.y,r.clear(),r.add(h.y))}),le.forEach(h=>{const O=h.x,Z=h.x+h.w,E=h.x+h.w/2;j.textAlign==="left"&&Math.abs(g-O)<n?(g=O,d.clear(),d.add(O)):j.textAlign==="right"&&Math.abs(g-Z)<n?(g=Z,d.clear(),d.add(Z)):j.textAlign==="center"&&Math.abs(g-E)<n&&(g=E,d.clear(),d.add(E));const M=h.y+h.h;Math.abs(s-M)<n&&(s=M,r.add(M))}),ie({x:Array.from(d),y:Array.from(r)}),T(J,g,s)},[G,J,F,T,le]),te=i.useCallback(()=>{oe(!1),we(null),de.current=null,ie({x:[],y:[]})},[]);i.useEffect(()=>(G?(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",te),window.addEventListener("touchmove",Q),window.addEventListener("touchend",te)):(window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",Q),window.removeEventListener("touchend",te)),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",te),window.removeEventListener("touchmove",Q),window.removeEventListener("touchend",te)}),[G,Q,te]);const ce=(t,o,f)=>"#"+[t,o,f].map(y=>{const N=y.toString(16);return N.length===1?"0"+N:N}).join("").toUpperCase(),me=t=>{if(!G&&P.current&&z.current){const o=P.current.getBoundingClientRect(),f=(t.clientX-o.left)/o.width*100,y=(t.clientY-o.top)/o.height*100;if(f>=0&&f<=100&&y>=0&&y<=100)if(S==="edit"&&B){let N="#000000",m="#FFFFFF";try{const j=z.current.getContext("2d",{willReadFrequently:!0});if(j){const g=Math.round(f/100*z.current.width),s=Math.round(y/100*z.current.height),n=3,r=j.getImageData(g-n,s-n,n*2+1,n*2+1).data,v={};let p={r:0,g:0,b:0,score:-1};for(let C=0;C<r.length;C+=4){const se=r[C],pe=r[C+1],ge=r[C+2];if(r[C+3]<128)continue;const k=ce(se,pe,ge);v[k]=(v[k]||0)+1;const u=Math.sqrt(Math.pow(255-se,2)+Math.pow(255-pe,2)+Math.pow(255-ge,2));u>p.score&&(p={r:se,g:pe,b:ge,score:u})}let x=0,$="#FFFFFF";for(const[C,se]of Object.entries(v))se>x&&(x=se,$=C);m=$;const h=parseInt(m.slice(1,3),16),O=parseInt(m.slice(3,5),16),Z=parseInt(m.slice(5,7),16);let E=m==="#FFFFFF"?"#000000":"#FFFFFF",M=-1;for(const C in v){const se=parseInt(C.slice(1,3),16),pe=parseInt(C.slice(3,5),16),ge=parseInt(C.slice(5,7),16),re=Math.sqrt(Math.pow(h-se,2)+Math.pow(O-pe,2)+Math.pow(Z-ge,2));re>M&&(M=re,E=C)}M>50&&(N=E)}}catch(j){console.error("Error sampling colors:",j)}B(f,y,N,m)}else I(f,y);else X(null)}};i.useEffect(()=>{a&&(l(a.numPages),ae(a,b))},[a,b,ae,l]);const c=F.filter(t=>t.pageNumber===b);return e.jsx("div",{className:"relative w-full h-full flex items-center justify-center p-8 bg-dots-light dark:bg-dots-dark overflow-auto",onClick:me,children:e.jsxs("div",{ref:P,className:"relative shadow-2xl rounded-sm bg-white",style:{width:R.width?"auto":"100%",maxWidth:"100%",aspectRatio:R.width?`${R.width}/${R.height}`:"auto"},children:[e.jsx("canvas",{ref:z,className:"max-w-full h-auto block"}),he.x.map((t,o)=>e.jsx("div",{className:"absolute top-0 bottom-0 border-l border-dashed border-ocean-500 z-50 pointer-events-none",style:{left:`${t}%`}},`snap-x-${o}`)),he.y.map((t,o)=>e.jsx("div",{className:"absolute left-0 right-0 border-t border-dashed border-ocean-500 z-50 pointer-events-none",style:{top:`${t}%`}},`snap-y-${o}`)),(H||K||!a)&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/50 dark:bg-black/50 backdrop-blur-sm z-50",children:e.jsx(Le,{className:"w-8 h-8 animate-spin text-ocean-500"})}),c.map(t=>t.originalRect&&e.jsx("div",{className:"absolute pointer-events-none z-0",style:{left:`${t.originalRect.x}%`,top:`${t.originalRect.y}%`,width:`${t.originalRect.w}%`,height:`${t.originalRect.h}%`,backgroundColor:t.backgroundColor||"#FFFFFF"}},`mask-${t.id}`)),c.map(t=>e.jsx("div",{id:`text-el-${t.id}`,onMouseDown:o=>fe(o,t.id),onTouchStart:o=>fe(o,t.id),onClick:o=>o.stopPropagation(),className:`absolute flex items-center ${(t.textAlign||"left")==="left"?"justify-start":t.textAlign==="right"?"justify-end":"justify-center"} rounded transition-all ${w===t.id?"bg-ocean-400/10 z-10":"hover:bg-ocean-400/5 z-0"}`,style:{left:`${t.x}%`,top:`${t.y}%`,transform:`${(t.textAlign||"left")==="left"?"translate(0, -50%)":t.textAlign==="right"?"translate(-100%, -50%)":"translate(-50%, -50%)"} rotate(${t.rotation}deg) scaleX(${t.horizontalScaling||1})`,cursor:w===t.id?"text":"grab",color:t.color,opacity:t.opacity/100,fontSize:`${t.fontSize*(R.width/(D.width||595))}px`,fontFamily:t.fontFamily,fontWeight:t.bold?"bold":"normal",fontStyle:t.italic?"italic":"normal",textAlign:t.textAlign||"left",whiteSpace:"pre",minWidth:"max-content",pointerEvents:G&&J!==t.id?"none":"auto",userSelect:w===t.id?"text":"none",outline:"none"},contentEditable:w===t.id,suppressContentEditableWarning:!0,onBlur:o=>{const f=o.currentTarget.textContent||"";f!==t.text&&_(t.id,{text:f})},onKeyDown:o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),o.currentTarget.blur())},children:t.text||" "},t.id)),c.map(t=>t.id===w&&t.originalRect&&e.jsx("div",{className:"absolute pointer-events-none border-2 border-dashed border-ocean-400/50 rounded-sm z-0",style:{left:`${t.originalRect.x}%`,top:`${t.originalRect.y}%`,width:`${t.originalRect.w}%`,height:`${t.originalRect.h}%`}},`original-rect-${t.id}`))]})})},Dt=({currentPage:a,totalPages:b,toolMode:F,canUndo:w,canRedo:S,onPageChange:I,onUndo:X,onRedo:T,onToolModeChange:_,onReset:l,onSave:B})=>{const{t:H}=Se();return e.jsxs("div",{className:"flex flex-nowrap items-center justify-between gap-2 p-2 bg-white/80 dark:bg-gray-900/80 backdrop-blur-md rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm transition-all overflow-x-auto no-scrollbar min-w-0",children:[e.jsxs("div",{className:"flex shrink-0 items-center gap-1.5 p-1 bg-gray-50/50 dark:bg-gray-800/50 rounded-xl border border-gray-100 dark:border-gray-700",children:[e.jsxs(A,{variant:F==="select"?"default":"ghost",size:"sm",onClick:()=>_("select"),className:`h-9 px-3 rounded-lg transition-all ${F==="select"?"bg-ocean-500 shadow-md text-white":""}`,children:[e.jsx(pt,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs font-semibold",children:H("addText.modeSelect")})]}),e.jsxs(A,{variant:F==="add"?"default":"ghost",size:"sm",onClick:()=>_("add"),className:`h-9 px-3 rounded-lg transition-all ${F==="add"?"bg-ocean-500 shadow-md text-white":""}`,children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs font-semibold",children:H("addText.modeAdd")})]}),e.jsxs(A,{variant:F==="edit"?"default":"ghost",size:"sm",onClick:()=>_("edit"),className:`h-9 px-3 rounded-lg transition-all ${F==="edit"?"bg-purple-500 shadow-md text-white hover:bg-purple-600":""}`,children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs font-semibold",children:H("editText.smartEdit")||"Smart Edit"})]})]}),e.jsx("div",{className:"flex shrink-0 items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50/50 dark:bg-gray-800/50 p-1 rounded-xl",children:[e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-lg",disabled:a<=1,onClick:()=>I(a-1),children:e.jsx(Qe,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-xs font-bold px-2 min-w-[60px] text-center whitespace-nowrap",children:[a," / ",b]}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-lg",disabled:a>=b,onClick:()=>I(a+1),children:e.jsx(Ze,{className:"w-4 h-4"})})]})}),e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-100 dark:border-gray-800 pr-2 mr-2",children:[e.jsx(A,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl text-red-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",title:H("common.reset"),onClick:()=>{window.confirm(H("common.clearAll")+"?")&&l()},children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl",disabled:!w,onClick:X,children:e.jsx(zt,{className:"w-4 h-4"})}),e.jsx(A,{variant:"ghost",size:"icon",className:"h-9 w-9 rounded-xl",disabled:!S,onClick:T,children:e.jsx(wt,{className:"w-4 h-4"})})]}),e.jsxs(A,{onClick:B,size:"sm",className:"bg-ocean-600 hover:bg-ocean-700 text-white shadow-lg hover:shadow-xl transition-all rounded-xl px-4 h-10 font-bold",children:[e.jsx(vt,{className:"w-4 h-4 mr-2"}),H("common.save")]})]})]})},ze=({selectedElement:a,onElementUpdate:b,onDelete:F})=>{const{t:w}=Se(),[S,I]=i.useState({style:!0,appearance:!0}),X=l=>{I(B=>({...B,[l]:!B[l]}))};if(!a)return e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center space-y-4 bg-gray-50/50 dark:bg-gray-900/20 rounded-2xl border-2 border-dashed border-gray-200 dark:border-gray-800",children:[e.jsx("div",{className:"w-12 h-12 bg-white dark:bg-gray-800 rounded-xl shadow-sm flex items-center justify-center text-gray-400",children:e.jsx(Ce,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:w("addText.format.title")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:w("addText.clickToEdit")})]})]});const T=["Roboto","Helvetica","Times New Roman","Courier New","Arial"],_=["#000000","#4B5563","#9CA3AF","#FFFFFF","#EF4444","#F97316","#F59E0B","#10B981","#3B82F6","#6366F1","#8B5CF6","#EC4899"];return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300 pb-20 md:pb-0",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-ocean-500"}),e.jsx(be,{className:"text-sm font-semibold",children:w("addText.format.textContent")})]}),e.jsx("textarea",{value:a.text,onChange:l=>b(a.id,{text:l.target.value}),placeholder:w("addText.format.placeholder"),className:"w-full min-h-[100px] p-3 text-sm bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-ocean-500/20 focus:border-ocean-500 outline-none transition-all resize-none shadow-sm"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-b border-gray-100 dark:border-gray-800 pb-4",children:[e.jsxs("button",{onClick:()=>X("style"),className:"flex items-center justify-between w-full py-2 group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 dark:bg-blue-900/30 rounded-lg group-hover:bg-blue-200 dark:group-hover:bg-blue-900/50 transition-colors",children:e.jsx(et,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsx("span",{className:"text-sm font-semibold",children:w("addText.format.fontFamily")})]}),S.style?e.jsx(Ne,{className:"w-4 h-4 text-gray-400"}):e.jsx(Fe,{className:"w-4 h-4 text-gray-400"})]}),S.style&&e.jsxs("div",{className:"pt-4 space-y-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsxs(tt,{value:a.fontFamily,onValueChange:l=>b(a.id,{fontFamily:l}),children:[e.jsx(at,{className:"w-full bg-white dark:bg-gray-800 rounded-xl h-10 border-gray-200 dark:border-gray-700",children:e.jsx(st,{})}),e.jsx(rt,{children:T.map(l=>e.jsx(nt,{value:l,children:e.jsx("span",{style:{fontFamily:l},children:l})},l))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.fontSize")}),e.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 bg-gray-100 dark:bg-gray-800 rounded",children:[a.fontSize,"px"]})]}),e.jsx("input",{type:"range",min:"8",max:"120",step:"1",value:a.fontSize,onChange:l=>b(a.id,{fontSize:parseInt(l.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-ocean-500"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{variant:a.bold?"default":"outline",size:"sm",onClick:()=>b(a.id,{bold:!a.bold}),className:`flex-1 rounded-xl h-10 ${a.bold?"bg-ocean-500 shadow-md text-white hover:bg-ocean-600":"bg-transparent text-gray-700 dark:text-gray-300"}`,children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),w("addText.format.bold")]}),e.jsxs(A,{variant:a.italic?"default":"outline",size:"sm",onClick:()=>b(a.id,{italic:!a.italic}),className:`flex-1 rounded-xl h-10 ${a.italic?"bg-ocean-500 shadow-md text-white hover:bg-ocean-600":"bg-transparent text-gray-700 dark:text-gray-300"}`,children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),w("addText.format.italic")]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.alignment")}),e.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-800 p-1 rounded-xl",children:["left","center","right"].map(l=>e.jsxs(A,{variant:"ghost",size:"sm",className:`flex-1 h-8 rounded-lg ${a.textAlign===l?"bg-white dark:bg-gray-700 shadow-sm text-ocean-600":"text-gray-500"}`,onClick:()=>{const B=a.textAlign||"left";if(B!==l){let H=a.x;const z=document.getElementById(`text-el-${a.id}`),P=z?.parentElement;if(z&&P){const R=z.getBoundingClientRect(),L=P.getBoundingClientRect(),D=R.width/L.width*100,W=K=>K==="center"?.5:K==="right"?1:0,Y=W(l)-W(B);H+=Y*D}b(a.id,{textAlign:l,x:H})}},children:[l==="left"&&e.jsx(Rt,{className:"w-4 h-4"}),l==="center"&&e.jsx(Ft,{className:"w-4 h-4"}),l==="right"&&e.jsx(St,{className:"w-4 h-4"})]},l))})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kt,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.fitToWidth")})]}),e.jsxs("span",{className:"text-xs font-bold",children:[Math.round((a.horizontalScaling||1)*100),"%"]})]}),e.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.01",value:a.horizontalScaling||1,onChange:l=>b(a.id,{horizontalScaling:parseFloat(l.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-ocean-500"})]})]})]}),e.jsxs("div",{className:"border-b border-gray-100 dark:border-gray-800 pb-4",children:[e.jsxs("button",{onClick:()=>X("appearance"),className:"flex items-center justify-between w-full py-2 group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-purple-100 dark:bg-purple-900/30 rounded-lg group-hover:bg-purple-200 dark:group-hover:bg-purple-900/50 transition-colors",children:e.jsx(ot,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),e.jsx("span",{className:"text-sm font-semibold",children:w("addText.format.textColor")})]}),S.appearance?e.jsx(Ne,{className:"w-4 h-4 text-gray-400"}):e.jsx(Fe,{className:"w-4 h-4 text-gray-400"})]}),S.appearance&&e.jsxs("div",{className:"pt-4 space-y-4 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"grid grid-cols-6 gap-2",children:_.map(l=>e.jsx("button",{onClick:()=>b(a.id,{color:l}),className:`w-8 h-8 rounded-full border-2 transition-transform hover:scale-110 shadow-sm ${a.color===l?"border-ocean-500 scale-110":"border-transparent"}`,style:{backgroundColor:l}},l))}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.opacity")})]}),e.jsxs("span",{className:"text-xs font-bold",children:[a.opacity,"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",step:"1",value:a.opacity,onChange:l=>b(a.id,{opacity:parseInt(l.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-ocean-500"})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.rotation")})]}),e.jsxs("span",{className:"text-xs font-bold",children:[a.rotation,"°"]})]}),e.jsx("input",{type:"range",min:"-180",max:"180",step:"1",value:a.rotation,onChange:l=>b(a.id,{rotation:parseInt(l.target.value)}),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-ocean-500"})]}),a.originalRect&&e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-100 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it,{className:"w-3.5 h-3.5 text-gray-400"}),e.jsx(be,{className:"text-xs text-gray-500",children:w("addText.format.backgroundColor")})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:["#FFFFFF","#F3F4F6","#E5E7EB","#D1D5DB","#FDF2F2","#000000"].map(l=>e.jsx("button",{className:`w-6 h-6 rounded border transition-transform hover:scale-110 ${a.backgroundColor===l?"ring-2 ring-ocean-500":"border-gray-200 dark:border-gray-700"}`,style:{backgroundColor:l},onClick:()=>b(a.id,{backgroundColor:l})},l))})]})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>F(a.id),className:"w-full h-11 rounded-xl text-red-500 hover:text-white hover:bg-red-500 hover:border-red-500 transition-all border-red-200 dark:border-red-900/30 bg-red-50 dark:bg-red-900/10",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),w("addText.format.delete")]})})]})},Pt=({element:a,onUpdate:b,isMobile:F})=>e.jsxs("div",{className:`
        flex items-center gap-1 p-1 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 shadow-xl rounded-xl backdrop-blur-md
        ${F?"fixed bottom-24 left-1/2 -translate-x-1/2 z-50 animate-in slide-in-from-bottom-4":"absolute bottom-full left-1/2 -translate-x-1/2 mb-4 animate-in fade-in slide-in-from-bottom-2"}
      `,children:[e.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-100 dark:border-gray-800 pr-1 mr-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${a.bold?"bg-ocean-100 dark:bg-ocean-900/30 text-ocean-600":""}`,onClick:()=>b(a.id,{bold:!a.bold}),children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsx(A,{variant:"ghost",size:"sm",className:`h-8 w-8 p-0 ${a.italic?"bg-ocean-100 dark:bg-ocean-900/30 text-ocean-600":""}`,onClick:()=>b(a.id,{italic:!a.italic}),children:e.jsx(He,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx(A,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>b(a.id,{fontSize:Math.max(8,a.fontSize-1)}),children:e.jsx(xt,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex items-center gap-1 min-w-[40px] justify-center",children:[e.jsx(Ce,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-xs font-bold",children:a.fontSize})]}),e.jsx(A,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>b(a.id,{fontSize:Math.min(120,a.fontSize+1)}),children:e.jsx(Ae,{className:"w-3 h-3"})})]})]});Ge.workerSrc=qe;const aa=()=>{const{t:a}=Se(),{status:b}=Ie(),F=b==="pro"||b==="lifetime",{currentTool:w}=Xe(),{sharedFile:S,clearSharedFile:I,setSharedFile:X}=We(),[T,_]=i.useState(null),[l,B]=i.useState(null),[H,z]=i.useState(!1),[P,R]=i.useState(null),[L,D]=i.useState(!1),[W,Y]=i.useState(!1),[K,V]=i.useState(!1),{textElements:q,selectedElementId:U,currentPage:ae,totalPages:G,toolMode:oe,isProcessing:J,canUndo:we,canRedo:de,addTextElement:he,updateTextElement:ie,deleteTextElement:le,selectElement:ue,moveElement:fe,goToPage:Q,setTotalPages:te,setToolMode:ce,undo:me,redo:c,detectTextAt:t,savePDF:o,reset:f,finishMovement:y}=Bt();i.useEffect(()=>{window.location.hash.slice(1).startsWith("add-text")?ce("add"):ce("edit")},[ce]),i.useEffect(()=>{const s=()=>D(window.innerWidth<1024);return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),i.useEffect(()=>{const s=n=>{if(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.target.isContentEditable)return;const r=navigator.platform.toUpperCase().indexOf("MAC")>=0?n.metaKey:n.ctrlKey;if(r&&n.key.toLowerCase()==="z")n.shiftKey?(n.preventDefault(),c()):(n.preventDefault(),me());else if(r&&n.key.toLowerCase()==="y")n.preventDefault(),c();else if((n.key==="Delete"||n.key==="Backspace")&&U)n.preventDefault(),le(U);else if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.key)&&U){const v=q.find(p=>p.id===U);if(v){n.preventDefault();const p=n.shiftKey?1:.1;let{x,y:$}=v;n.key==="ArrowUp"&&($-=p),n.key==="ArrowDown"&&($+=p),n.key==="ArrowLeft"&&(x-=p),n.key==="ArrowRight"&&(x+=p),fe(U,x,$),y()}}};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[me,c,U,le,q,fe,y]);const N=i.useCallback(async s=>{const n=s[0];if(n){V(!0);try{const d=await n.arrayBuffer(),r=await Ke({data:d}).promise;R(r);const v={id:`${Date.now()}`,file:n,name:n.name,size:n.size,status:"completed"};_(v),B(null),z(!1),f()}catch(d){console.error("Error loading PDF:",d)}finally{V(!1)}}},[f]),m=i.useCallback(async(s,n,d,r)=>{if(!P)return;const v=q.find(x=>x.pageNumber!==ae?!1:Math.sqrt(Math.pow(x.x-s,2)+Math.pow(x.y-n,2))<3);if(v){ue(v.id);return}const p=await t(P,ae,s,n);if(p){const x=p.x-p.width/2;he(x,p.y,p.text,{fontSize:p.fontSize,fontFamily:p.fontFamily,bold:p.bold,italic:p.italic,color:d||"#000000",textAlign:"left",originalRect:{x:p.x-p.width/2,y:p.y-p.height/2,w:p.width,h:p.height},backgroundColor:r||"#FFFFFF"})}},[P,ae,t,he,q,ue]);i.useEffect(()=>{if(S&&!T){const s=new File([S.blob],S.name,{type:"application/pdf"});N([s]),I()}},[S,T,I,N]),i.useEffect(()=>{if(l&&!J&&!H){const s=T?.name.replace(/\.pdf$/i,"_edited.pdf")||"edited.pdf";X(l,s,"content-editor-pdf"),z(!0)}},[l,J,H,T?.name,X]);const j=q.find(s=>s.id===U)||null,g=i.useCallback(async()=>{if(T?.file)try{let s=await o(T.file);B(s)}catch(s){console.error("Error saving PDF:",s)}},[T,o]);return T?l?e.jsx(ke,{title:a(`tools.${w}.name`),description:a(`tools.${w}.description`),hasFiles:!0,onUpload:N,children:e.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto py-12",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-200 dark:border-green-800 rounded-3xl p-10 text-center shadow-xl",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 dark:bg-green-900/50 rounded-full flex items-center justify-center mx-auto mb-6 shadow-inner",children:e.jsx(_e,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:a("common.success")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:a("addText.addedCount",{count:q.length})})]}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx(lt,{toolId:"edit-pdf",onDownload:async s=>{if(!l)return;let n=l;if(!F&&s)try{const v=await l.arrayBuffer(),p=await Ye.applyWatermark(new Uint8Array(v));n=new Blob([new Uint8Array(p)],{type:"application/pdf"})}catch(v){console.error("Failed to apply watermark:",v)}const d=URL.createObjectURL(n),r=document.createElement("a");r.href=d,r.download=T.name.replace(".pdf","_edited.pdf"),r.click(),URL.revokeObjectURL(d)},className:"flex-1",showWatermarkLabel:!F}),e.jsxs(A,{variant:"outline",onClick:()=>{_(null),B(null),I(),f()},className:"h-11 px-8 rounded-xl font-bold border-2",children:[e.jsx(ct,{className:"mr-2 h-4 w-4"}),a("common.processAnother")]})]})]})}):e.jsx(ke,{title:a(`tools.${w}.name`),description:a(`tools.${w}.description`),hasFiles:!0,onUpload:N,isProcessing:J,settings:L?null:e.jsx(ze,{selectedElement:j,onElementUpdate:ie,onDelete:le}),actions:L?null:e.jsx(A,{onClick:g,disabled:J,className:"w-full h-12 rounded-xl font-bold bg-ocean-500 text-white",children:a("common.save")}),children:e.jsxs("div",{className:"flex flex-col h-full space-y-4 relative",children:[e.jsx(Dt,{currentPage:ae,totalPages:G,toolMode:oe,canUndo:we,canRedo:de,onPageChange:Q,onUndo:me,onRedo:c,onToolModeChange:ce,onReset:f,onSave:g}),e.jsxs("div",{className:"flex-1 bg-gray-100 dark:bg-gray-800 rounded-2xl relative border border-gray-200 dark:border-gray-700 shadow-inner overflow-hidden",children:[e.jsx(Ht,{pdfDocument:P,isDocumentLoading:K,currentPage:ae,textElements:q,selectedElementId:U,toolMode:oe,onCanvasClick:(s,n)=>{oe==="add"?(he(s,n,a("addText.clickToEdit")),ce("select")):ue(null)},onElementSelect:ue,onElementMove:(s,n,d)=>{fe(s,n,d),L&&Y(!0)},onElementUpdate:ie,onTotalPagesChange:te,onSmartDetect:m}),j&&e.jsx(Pt,{element:j,onUpdate:ie,isMobile:L})]}),L&&j&&e.jsx(A,{className:"fixed bottom-6 right-6 w-14 h-14 rounded-full shadow-2xl bg-ocean-500 text-white z-[60] p-0",onClick:()=>Y(!W),children:W?e.jsx(Fe,{className:"w-6 h-6"}):e.jsx(Ne,{className:"w-6 h-6"})}),L&&W&&e.jsxs("div",{className:"fixed inset-x-0 bottom-0 bg-white dark:bg-gray-900 z-[55] border-t border-gray-200 dark:border-gray-800 p-6 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.1)] animate-in slide-in-from-bottom-full duration-300",children:[e.jsx("div",{className:"w-12 h-1.5 bg-gray-200 dark:bg-gray-800 rounded-full mx-auto mb-6",onClick:()=>Y(!1)}),e.jsx(ze,{selectedElement:j,onElementUpdate:ie,onDelete:le})]})]})}):e.jsx(ke,{title:a(`tools.${w}.name`),description:a(`tools.${w}.description`),hasFiles:!1,onUpload:N,isProcessing:!1,maxFiles:1})};export{aa as ContentEditorPDF};
